/*!
 *
 * The MIT License (MIT)
 *
 * Copyright © 2024 Taufik Nurrohman <https://github.com/taufik-nurrohman>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the “Software”), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED “AS IS”, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */
!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(t="undefined"!=typeof globalThis?globalThis:t||self).TagPicker=n()}(this,(function(){"use strict";var t=function(t){return Array.isArray(t)},n=function(t){return"function"==typeof t},e=function(t,n){return t&&i(n)&&t instanceof n},r=function(t,n){return void 0===n&&(n=!0),"object"==typeof t&&(!n||e(t,Object))},i=function(t){return function(t){return void 0!==t}(t)&&!function(t){return null===t}(t)},o=function(t){return"string"==typeof t},a=function(t){return t.toLowerCase()},u=function(t){return t.length},s=function n(){for(var e=arguments.length,o=Array(e),a=0;a<e;a++)o[a]=arguments[a];for(var s,f=o.shift(),c=0,l=u(o);c<l;++c)for(var d in o[c])if(i(f[d]))if(t(f[d])&&t(o[c][d])){f[d]=[].concat(f[d]);for(var v=0,h=u(o[c][d]);v<h;++v)s=o[c][d][v],-1===f[d].indexOf(s)&&f[d].push(o[c][d][v])}else r(f[d])&&r(o[c][d])?f[d]=n({},f[d],o[c][d]):f[d]=o[c][d];else f[d]=o[c][d];return f},f=function n(e){if(t(e))return e.map((function(t){return n(e)}));if(r(e)){for(var i in e)e[i]=n(e[i]);return e}return!1===e?"false":null===e?"null":!0===e?"true":""+e},c=document,l=function(t,n){return n?t.closest(n)||null:t.parentNode||null},d=function(t){var n="form";return h(t,n)&&n===function(t){return a(t&&t.nodeName||"")||null}(t[n])?t[n]:l(t,n)},v=function(t,n){void 0===n&&(n=!0);var e="textContent";if(!h(t,e))return!1;var r=t[e];return""!==(r=n?r.trim():r)?r:null},h=function(t,n){return n in t},p=function(t,n){return t.removeAttribute(n),t},_=function(t,n,e){return!0===e&&(e=n),t.setAttribute(n,f(e)),t},m=function(t,n){return t.append(n),n},w=function(t,n,e){return t=o(t)?c.createElement(t):t,r(n)&&(e=n,n=!1),o(n)&&g(t,n),r(e)&&function(t,n){var e;for(var r in n)(e=n[r])||""===e||0===e?_(t,r,e):p(t,r)}(t,e),t},g=function(t,n,e){if(void 0===e&&(e=!0),null===n)return t;var r="innerHTML";return h(t,r)&&(t[r]=e?n.trim():n),t};var y=function(t,n,e){n.removeEventListener(t,e)},b=function(t){return t&&t.preventDefault()},k=function(t,n,e,r){void 0===r&&(r=!1),n.addEventListener(t,e,r)};function x(t){return t.disabled}function j(t,n){return(v(t)||"").split(n).join("")}function A(t,n){var r=this;return t?e(r,A)?(t["_"+A.name]=function(t,n){return(n=n||t).fire=function(t,n){var e=this,r=e.hooks;return i(r[t])?(r[t].forEach((function(t){return t.apply(e,n)})),e):e},n.off=function(t,n){var e=this,r=e.hooks;if(!i(t))return r={},e;if(i(r[t]))if(i(n)){var o=r[t].length;if(0===o)delete r[t];else for(var a=0;a<o;++a)if(n===r[t][a]){r[t].splice(a,1);break}}else delete r[t];return e},n.on=function(t,n){var e=this.hooks;return i(e[t])||(e[t]=[]),i(n)&&e[t].push(n),this},t.hooks={},t}(r,A.prototype),r.attach(t,s({},A.state,o(n)?{join:n}:n||{}))):new A(t,n):r}A.state={class:"tag-picker",escape:[","],join:", ",max:9999,min:0,pattern:null,with:[]},A.version="4.0.0",Object.defineProperty(A,"name",{value:"TagPicker"});var L=A.prototype;function T(t){var n,e=this;e["_"+A.name],y("click",e,T),n=l(e),l(n),n.remove(),b(t)}function C(){var t=this["_"+A.name];t._shadow.input&&t._shadow.input.focus()}function E(t){var n=this,e=t.key,r=t.keyCode,i=n["_"+A.name],o=i.state.escape;if(o.includes(e)||o.includes(r))return console.log(e),i.set(j(n,i.state.join)),b(t);console.log(j(n))}return L._filter=function(t){return a(t||"").trim()},L.attach=function(e,a){var s,f=this;e=e||f.self,a=a||f.state,f._active=!0,f._shadow={},f._value=s=function(t){return t.value.replace(/\r/g,"")}(e),f.self=f._shadow.of=e,f.state=a,f.tags=s.split(a.join);var c=a.class,v=c+"__";d(e);var h=w("div",{class:c,tabindex:!x(e)&&-1}),p=w("span",{class:v+"tags"}),_=w("span",{class:v+"tag "+v+"text"});w("input",{class:v+"copy",tabindex:-1,type:"text"});var g,y,b=w("span",{contenteditable:!x(e)&&"true",spellcheck:"false",style:"white-space:pre;"}),j=w("span");if(m(h,p),m(p,_),m(_,b),m(_,j),function(t,n){t.classList.add(n)}(e,v+"self"),y=h,l(g=e).insertBefore(y,function(t,n){return t.nextSibling||null}(g)),k("focus",e,C),k("keydown",b,E),b["_"+A.name]=f,f._shadow.input=b,f._shadow.self=h,f._shadow.tags=p,f._shadow.text=_,i(a)&&t(a.with))for(var L=0,T=u(a.with);L<T;++L){var O=a.with[L];o(O)&&(O=A[O]),n(O)?O.call(f,e,a):r(O)&&n(O.attach)&&O.attach.call(f,e,a)}return f},L.blur=function(){},L.click=function(){},L.detach=function(){var e=this,i=e.self,a=e.state;if(e._active=!1,y("focus",i,C),y("keydown",i._shadow.input,E),t(a.with))for(var s=0,f=u(a.with);s<f;++s){var c=a.with[s];o(c)&&(c=A[c]),r(c)&&n(c.detach)&&c.detach.call(e,i,a)}return e},L.focus=function(){},L.get=function(){},L.let=function(){},L.set=function(t){var n,e,r=this,i=w("span",{class:r.state.class+"__tag",tabindex:-1}),o=w("span",t),a=w("a",{class:r.state.class+"__tag-x",href:"",tabindex:-1,target:"_top"});k("click",a,T),m(i,o),m(i,a),n=r._shadow.text,e=i,l(n).insertBefore(e,n),function(t,n,e){void 0===e&&(e=!0);var r="textContent";h(t,r)&&(t[r]=e?n.trim():n)}(r._shadow.input,"")},Object.defineProperty(L,"value",{get:function(){return this.self.value},set:function(t){this.self.value=t}}),A}));