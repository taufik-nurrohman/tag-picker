/*!
 *
 * The MIT License (MIT)
 *
 * Copyright © 2024 Taufik Nurrohman <https://github.com/taufik-nurrohman>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the “Software”), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED “AS IS”, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */
!function(u,D){"object"==typeof exports&&"undefined"!=typeof module?module.exports=D():"function"==typeof define&&define.amd?define(D):(u="undefined"!=typeof globalThis?globalThis:u||self).TagPicker=D()}(this,(function(){"use strict";var u=function(u,D){return-1!==D.indexOf(u)},D=function(u){return Array.isArray(u)},F=function(u){return void 0!==u},t=function(u){return"function"==typeof u},e=function(u,D){return u&&r(D)&&u instanceof D},n=function(u,D){return void 0===D&&(D=!0),"object"==typeof u&&(!D||e(u,Object))},r=function(u){return F(u)&&!function(u){return null===u}(u)},i=function(u){return"string"==typeof u},E=function(u){return u.length},a=function(u){return E(C(u))},C=function(u){return Object.keys(u)},s=function(u){return Object.values(u)},o=function u(F){if(D(F))return F.map((function(D){return u(D)}));if(function(u){return/^-?(?:\d*.)?\d+$/.test(u+"")}(F))return function(u,D){return void 0===D&&(D=10),D?parseInt(u,D):parseFloat(u)}(F);if(n(F)){for(var t in F)F[t]=u(F[t]);return F}return"false"!==F&&("null"===F?null:"true"===F||F)},A=function F(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];for(var a=e.shift(),C=0,s=E(e);C<s;++C)for(var o in e[C])if(r(a[o]))if(D(a[o])&&D(e[C][o])){a[o]=[].concat(a[o]);for(var A=0,f=E(e[C][o]);A<f;++A)u(e[C][o][A],a[o])||a[o].push(e[C][o][A])}else n(a[o])&&n(e[C][o])?a[o]=F({},a[o],e[C][o]):a[o]=e[C][o];else a[o]=e[C][o];return a},f=function u(F){if(D(F))return F.map((function(D){return u(F)}));if(n(F)){for(var t in F)F[t]=u(F[t]);return F}return!1===F?"false":null===F?"null":!0===F?"true":""+F},c=document,l=window,B=function(u){return u.firstElementChild||null},p=function(u,D){var F=u.children;return"number"==typeof D?F[D]||null:F||[]},v=function(u,D){return u["next"+(D?"":"Element")+"Sibling"]||null},h=function(u,D){return D?u.closest(D)||null:u.parentNode||null},_=function(u){var D="form";return b(u,D)&&D===function(u){return(u&&u.nodeName||"").toLowerCase()||null}(u[D])?u[D]:h(u,D)},g=function(u,D){return u.previousElementSibling||null},d=function(u,D){void 0===D&&(D=!0);var F="textContent";if(!b(u,F))return!1;var t=u[F];return""!==(t=D?t.trim():t)?t:null},m=function(u,D){return u.hasAttribute(D)},k=function(u,D){return u.classList.contains(D)},b=function(u,D){return D in u},x=function(u,D){return u.removeAttribute(D),u},y=function(u,D){return u.classList.remove(D),u},j=function(u){var D=h(u);return u.remove(),D},w=function(u,D,F){return!0===F&&(F=D),u.setAttribute(D,f(F)),u},S=function(u,D){return u.append(D),D},T=function(u,D){return u.classList.add(D),u},R=function(u,D,F){return u=i(u)?c.createElement(u):u,n(D)&&(F=D,D=!1),i(D)&&L(u,D),n(F)&&function(u,D){var F;for(var t in D)(F=D[t])||""===F||0===F?w(u,t,F):x(u,t)}(u,F),u},L=function(u,D,F){if(void 0===F&&(F=!0),null===D)return u;var t="innerHTML";return b(u,t)&&(u[t]=F?D.trim():D),u},O=function(u,D,F){if(void 0===F&&(F=!0),null===D)return u;var t="textContent";return b(u,t)&&(u[t]=F?D.trim():D),u},q=function(u,D,F){return u.classList.toggle(D,F),u},N=function(u,D){return function(){var F=arguments,t=this;setTimeout((function(){return u.apply(t,F)}),D)}};var K=function(u,D,F){D.removeEventListener(u,F)},P=function(u){return u&&u.preventDefault()},I=function(u,D,F,t){void 0===t&&(t=!1),D.addEventListener(u,F,t)},H=function(u,D){return function(u){return e(u,RegExp)}(u)?u:RegExp(u,r(D)?D:"g")},M="ArrowLeft",$="ArrowRight",z="Home",G="Backspace",J="End",Q="Enter",U="TagPicker";function V(u,D,F){Object.defineProperty(u,D,F)}function W(u){u.focus()}function X(u){var D,F=l.getSelection();if(F.rangeCount)return(D=F.getRangeAt(0).cloneRange()).collapse(!0),D.setStart(u,0),(D+"").slice(-1)}function Y(u){return(u.value||function(u,D,F){if(void 0===F&&(F=!0),!m(u,D))return null;var t=u.getAttribute(D);return F?o(t):t}(u,"value",!1)||"").replace(/\r/g,"")}function Z(u){return u.disabled}function uu(u){var D=c.getSelection();D.rangeCount&&D.removeRange(D.getRangeAt(0))}function Du(u,D){var F=c.getSelection();uu();var t=c.createRange();t.selectNodeContents(u),F.addRange(t),1===D?F.collapseToEnd():-1===D&&F.collapseToStart()}function Fu(u,D){var F=this;if(!u)return F;if(!e(F,Fu))return new Fu(u,D);u["_"+U]=function(u,D){return(D=D||u).fire=function(u,D){var F=this,t=F.hooks;return r(t[u])?(t[u].forEach((function(u){return u.apply(F,D)})),F):F},D.off=function(u,D){var F=this,t=F.hooks;if(!r(u))return t={},F;if(r(t[u]))if(r(D)){var e=t[u].length;if(0===e)delete t[u];else for(var n=0;n<e;++n)if(D===t[u][n]){t[u].splice(n,1);break}}else delete t[u];return F},D.on=function(u,D){var F=this.hooks;return r(F[u])||(F[u]=[]),r(D)&&F[u].push(D),this},u.hooks={},u}(F,Fu.prototype);var t=A({},Fu.state,i(D)?{join:D}:D||{});return n(D)&&D.escape&&(t.escape=D.escape),F.attach(u,t)}Fu.state={escape:[","],join:", ",max:1/0,min:0,n:"tag-picker",pattern:null,with:[]},Fu.version="4.0.0",V(Fu,"name",{value:U});var tu=Fu.prototype;V(tu,"text",{get:function(){return d(this._mask.input)},set:function(u){var D=this._mask,F=this.self,t=D.hint,e=D.input;O(t,""===(u+="")?F.placeholder:""),O(e,u),Du(e)}}),V(tu,"value",{get:function(){return this.self.value||null},set:function(u){var D=this;D._tags;var F=D.state;D.value&&D.value.split(F.join).forEach((function(u){return D.let(u,0)})),u.split(F.join).forEach((function(u){return D.set(u,0)})),D.fire("change")}}),tu._filter=function(u){var D=this.state;return(u||"").replace(/(?:[\0- \x7F-\xA0\xAD\u0300-\u036F\u0378\u0379\u0380-\u0383\u038B\u038D\u03A2\u0483-\u0489\u0530\u0557\u0558\u058B\u058C\u0590-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7-\u05CF\u05EB-\u05EE\u05F5-\u0605\u0610-\u061A\u061C\u064B-\u065F\u0670\u06D6-\u06DD\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u070E\u070F\u0711\u0730-\u074C\u07A6-\u07B0\u07B2-\u07BF\u07EB-\u07F3\u07FB-\u07FD\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082F\u083F\u0859-\u085D\u085F\u086B-\u086F\u088F-\u089F\u08CA-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0981-\u0984\u098D\u098E\u0991\u0992\u09A9\u09B1\u09B3-\u09B5\u09BA-\u09BC\u09BE-\u09CD\u09CF-\u09DB\u09DE\u09E2-\u09E5\u09FE-\u0A04\u0A0B-\u0A0E\u0A11\u0A12\u0A29\u0A31\u0A34\u0A37\u0A3A-\u0A58\u0A5D\u0A5F-\u0A65\u0A70\u0A71\u0A75\u0A77-\u0A84\u0A8E\u0A92\u0AA9\u0AB1\u0AB4\u0ABA-\u0ABC\u0ABE-\u0ACF\u0AD1-\u0ADF\u0AE2-\u0AE5\u0AF2-\u0AF8\u0AFA-\u0B04\u0B0D\u0B0E\u0B11\u0B12\u0B29\u0B31\u0B34\u0B3A-\u0B3C\u0B3E-\u0B5B\u0B5E\u0B62-\u0B65\u0B78-\u0B82\u0B84\u0B8B-\u0B8D\u0B91\u0B96-\u0B98\u0B9B\u0B9D\u0BA0-\u0BA2\u0BA5-\u0BA7\u0BAB-\u0BAD\u0BBA-\u0BCF\u0BD1-\u0BE5\u0BFB-\u0C04\u0C0D\u0C11\u0C29\u0C3A-\u0C3C\u0C3E-\u0C57\u0C5B\u0C5C\u0C5E\u0C5F\u0C62-\u0C65\u0C70-\u0C76\u0C81-\u0C83\u0C8D\u0C91\u0CA9\u0CB4\u0CBA-\u0CBC\u0CBE-\u0CDC\u0CDF\u0CE2-\u0CE5\u0CF0\u0CF3-\u0D03\u0D0D\u0D11\u0D3B\u0D3C\u0D3E-\u0D4D\u0D50-\u0D53\u0D57\u0D62-\u0D65\u0D80-\u0D84\u0D97-\u0D99\u0DB2\u0DBC\u0DBE\u0DBF\u0DC7-\u0DE5\u0DF0-\u0DF3\u0DF5-\u0E00\u0E31\u0E34-\u0E3E\u0E47-\u0E4E\u0E5C-\u0E80\u0E83\u0E85\u0E8B\u0EA4\u0EA6\u0EB1\u0EB4-\u0EBC\u0EBE\u0EBF\u0EC5\u0EC7-\u0ECF\u0EDA\u0EDB\u0EE0-\u0EFF\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F48\u0F6D-\u0F84\u0F86\u0F87\u0F8D-\u0FBD\u0FC6\u0FCD\u0FDB-\u0FFF\u102B-\u103E\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109D\u10C6\u10C8-\u10CC\u10CE\u10CF\u1249\u124E\u124F\u1257\u1259\u125E\u125F\u1289\u128E\u128F\u12B1\u12B6\u12B7\u12BF\u12C1\u12C6\u12C7\u12D7\u1311\u1316\u1317\u135B-\u135F\u137D-\u137F\u139A-\u139F\u13F6\u13F7\u13FE\u13FF\u1680\u169D-\u169F\u16F9-\u16FF\u1712-\u171E\u1732-\u1734\u1737-\u173F\u1752-\u175F\u176D\u1771-\u177F\u17B4-\u17D3\u17DD-\u17DF\u17EA-\u17EF\u17FA-\u17FF\u180B-\u180F\u181A-\u181F\u1879-\u187F\u1885\u1886\u18A9\u18AB-\u18AF\u18F6-\u18FF\u191F-\u193F\u1941-\u1943\u196E\u196F\u1975-\u197F\u19AC-\u19AF\u19CA-\u19CF\u19DB-\u19DD\u1A17-\u1A1D\u1A55-\u1A7F\u1A8A-\u1A8F\u1A9A-\u1A9F\u1AAE-\u1B04\u1B34-\u1B44\u1B4D-\u1B4F\u1B6B-\u1B73\u1B7F-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BFB\u1C24-\u1C3A\u1C4A-\u1C4C\u1C89-\u1C8F\u1CBB\u1CBC\u1CC8-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF4\u1CF7-\u1CF9\u1CFB-\u1CFF\u1DC0-\u1DFF\u1F16\u1F17\u1F1E\u1F1F\u1F46\u1F47\u1F4E\u1F4F\u1F58\u1F5A\u1F5C\u1F5E\u1F7E\u1F7F\u1FB5\u1FC5\u1FD4\u1FD5\u1FDC\u1FF0\u1FF1\u1FF5\u1FFF-\u200F\u2028-\u202F\u205F-\u206F\u2072\u2073\u208F\u209D-\u209F\u20C1-\u20FF\u218C-\u218F\u2427-\u243F\u244B-\u245F\u2B74\u2B75\u2B96\u2CEF-\u2CF1\u2CF4-\u2CF8\u2D26\u2D28-\u2D2C\u2D2E\u2D2F\u2D68-\u2D6E\u2D71-\u2D7F\u2D97-\u2D9F\u2DA7\u2DAF\u2DB7\u2DBF\u2DC7\u2DCF\u2DD7\u2DDF-\u2DFF\u2E5E-\u2E7F\u2E9A\u2EF4-\u2EFF\u2FD6-\u2FEF\u3000\u302A-\u302F\u3040\u3097-\u309A\u3100-\u3104\u3130\u318F\u31E4-\u31EE\u321F\uA48D-\uA48F\uA4C7-\uA4CF\uA62C-\uA63F\uA66F-\uA672\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA6F8-\uA6FF\uA7CB-\uA7CF\uA7D2\uA7D4\uA7DA-\uA7F1\uA802\uA806\uA80B\uA823-\uA827\uA82C-\uA82F\uA83A-\uA83F\uA878-\uA881\uA8B4-\uA8CD\uA8DA-\uA8F1\uA8FF\uA926-\uA92D\uA947-\uA95E\uA97D-\uA983\uA9B3-\uA9C0\uA9CE\uA9DA-\uA9DD\uA9E5\uA9FF\uAA29-\uAA3F\uAA43\uAA4C-\uAA4F\uAA5A\uAA5B\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAC3-\uAADA\uAAEB-\uAAEF\uAAF5-\uAB00\uAB07\uAB08\uAB0F\uAB10\uAB17-\uAB1F\uAB27\uAB2F\uAB6C-\uAB6F\uABE3-\uABEA\uABEC-\uABEF\uABFA-\uABFF\uD7A4-\uD7AF\uD7C7-\uD7CA\uD7FC-\uD7FF\uE000-\uF8FF\uFA6E\uFA6F\uFADA-\uFAFF\uFB07-\uFB12\uFB18-\uFB1C\uFB1E\uFB37\uFB3D\uFB3F\uFB42\uFB45\uFBC3-\uFBD2\uFD90\uFD91\uFDC8-\uFDCE\uFDD0-\uFDEF\uFE00-\uFE0F\uFE1A-\uFE2F\uFE53\uFE67\uFE6C-\uFE6F\uFE75\uFEFD-\uFF00\uFFBF-\uFFC1\uFFC8\uFFC9\uFFD0\uFFD1\uFFD8\uFFD9\uFFDD-\uFFDF\uFFE7\uFFEF-\uFFFB\uFFFE\uFFFF]|\uD800[\uDC0C\uDC27\uDC3B\uDC3E\uDC4E\uDC4F\uDC5E-\uDC7F\uDCFB-\uDCFF\uDD03-\uDD06\uDD34-\uDD36\uDD8F\uDD9D-\uDD9F\uDDA1-\uDDCF\uDDFD-\uDE7F\uDE9D-\uDE9F\uDED1-\uDEE0\uDEFC-\uDEFF\uDF24-\uDF2C\uDF4B-\uDF4F\uDF76-\uDF7F\uDF9E\uDFC4-\uDFC7\uDFD6-\uDFFF]|\uD801[\uDC9E\uDC9F\uDCAA-\uDCAF\uDCD4-\uDCD7\uDCFC-\uDCFF\uDD28-\uDD2F\uDD64-\uDD6E\uDD7B\uDD8B\uDD93\uDD96\uDDA2\uDDB2\uDDBA\uDDBD-\uDDFF\uDF37-\uDF3F\uDF56-\uDF5F\uDF68-\uDF7F\uDF86\uDFB1\uDFBB-\uDFFF]|\uD802[\uDC06\uDC07\uDC09\uDC36\uDC39-\uDC3B\uDC3D\uDC3E\uDC56\uDC9F-\uDCA6\uDCB0-\uDCDF\uDCF3\uDCF6-\uDCFA\uDD1C-\uDD1E\uDD3A-\uDD3E\uDD40-\uDD7F\uDDB8-\uDDBB\uDDD0\uDDD1\uDE01-\uDE0F\uDE14\uDE18\uDE36-\uDE3F\uDE49-\uDE4F\uDE59-\uDE5F\uDEA0-\uDEBF\uDEE5-\uDEEA\uDEF7-\uDEFF\uDF36-\uDF38\uDF56\uDF57\uDF73-\uDF77\uDF92-\uDF98\uDF9D-\uDFA8\uDFB0-\uDFFF]|\uD803[\uDC49-\uDC7F\uDCB3-\uDCBF\uDCF3-\uDCF9\uDD24-\uDD2F\uDD3A-\uDE5F\uDE7F\uDEAA-\uDEAC\uDEAE\uDEAF\uDEB2-\uDEFF\uDF28-\uDF2F\uDF46-\uDF50\uDF5A-\uDF6F\uDF82-\uDF85\uDF8A-\uDFAF\uDFCC-\uDFDF\uDFF7-\uDFFF]|\uD804[\uDC00-\uDC02\uDC38-\uDC46\uDC4E-\uDC51\uDC70\uDC73\uDC74\uDC76-\uDC82\uDCB0-\uDCBA\uDCBD\uDCC2-\uDCCF\uDCE9-\uDCEF\uDCFA-\uDD02\uDD27-\uDD35\uDD45\uDD46\uDD48-\uDD4F\uDD73\uDD77-\uDD82\uDDB3-\uDDC0\uDDC9-\uDDCC\uDDCE\uDDCF\uDDE0\uDDF5-\uDDFF\uDE12\uDE2C-\uDE37\uDE3E\uDE41-\uDE7F\uDE87\uDE89\uDE8E\uDE9E\uDEAA-\uDEAF\uDEDF-\uDEEF\uDEFA-\uDF04\uDF0D\uDF0E\uDF11\uDF12\uDF29\uDF31\uDF34\uDF3A-\uDF3C\uDF3E-\uDF4F\uDF51-\uDF5C\uDF62-\uDFFF]|\uD805[\uDC35-\uDC46\uDC5C\uDC5E\uDC62-\uDC7F\uDCB0-\uDCC3\uDCC8-\uDCCF\uDCDA-\uDD7F\uDDAF-\uDDC0\uDDDC-\uDDFF\uDE30-\uDE40\uDE45-\uDE4F\uDE5A-\uDE5F\uDE6D-\uDE7F\uDEAB-\uDEB7\uDEBA-\uDEBF\uDECA-\uDEFF\uDF1B-\uDF2F\uDF47-\uDFFF]|\uD806[\uDC2C-\uDC3A\uDC3C-\uDC9F\uDCF3-\uDCFE\uDD07\uDD08\uDD0A\uDD0B\uDD14\uDD17\uDD30-\uDD3E\uDD40\uDD42\uDD43\uDD47-\uDD4F\uDD5A-\uDD9F\uDDA8\uDDA9\uDDD1-\uDDE0\uDDE4-\uDDFF\uDE01-\uDE0A\uDE33-\uDE39\uDE3B-\uDE3E\uDE47-\uDE4F\uDE51-\uDE5B\uDE8A-\uDE99\uDEA3-\uDEAF\uDEF9-\uDEFF\uDF0A-\uDFFF]|\uD807[\uDC09\uDC2F-\uDC3F\uDC46-\uDC4F\uDC6D-\uDC6F\uDC90-\uDCFF\uDD07\uDD0A\uDD31-\uDD45\uDD47-\uDD4F\uDD5A-\uDD5F\uDD66\uDD69\uDD8A-\uDD97\uDD99-\uDD9F\uDDAA-\uDEDF\uDEF3-\uDEF6\uDEF9-\uDF01\uDF03\uDF11\uDF34-\uDF42\uDF5A-\uDFAF\uDFB1-\uDFBF\uDFF2-\uDFFE]|\uD808[\uDF9A-\uDFFF]|\uD809[\uDC6F\uDC75-\uDC7F\uDD44-\uDFFF]|[\uD80A\uD80E-\uD810\uD812-\uD819\uD824-\uD82A\uD82D\uD82E\uD830-\uD832\uD83F\uD87C\uD87D\uD87F\uD889-\uDBFF][\uDC00-\uDFFF]|\uD80B[\uDC00-\uDF8F\uDFF3-\uDFFF]|\uD80D[\uDC30-\uDC40\uDC47-\uDFFF]|\uD811[\uDE47-\uDFFF]|\uD81A[\uDE39-\uDE3F\uDE5F\uDE6A-\uDE6D\uDEBF\uDECA-\uDECF\uDEEE-\uDEF4\uDEF6-\uDEFF\uDF30-\uDF36\uDF46-\uDF4F\uDF5A\uDF62\uDF78-\uDF7C\uDF90-\uDFFF]|\uD81B[\uDC00-\uDE3F\uDE9B-\uDEFF\uDF4B-\uDF4F\uDF51-\uDF92\uDFA0-\uDFDF\uDFE4-\uDFFF]|\uD821[\uDFF8-\uDFFF]|\uD823[\uDCD6-\uDCFF\uDD09-\uDFFF]|\uD82B[\uDC00-\uDFEF\uDFF4\uDFFC\uDFFF]|\uD82C[\uDD23-\uDD31\uDD33-\uDD4F\uDD53\uDD54\uDD56-\uDD63\uDD68-\uDD6F\uDEFC-\uDFFF]|\uD82F[\uDC6B-\uDC6F\uDC7D-\uDC7F\uDC89-\uDC8F\uDC9A\uDC9B\uDC9D\uDC9E\uDCA0-\uDFFF]|\uD833[\uDC00-\uDF4F\uDFC4-\uDFFF]|\uD834[\uDCF6-\uDCFF\uDD27\uDD28\uDD65-\uDD69\uDD6D-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDDEB-\uDDFF\uDE42-\uDE44\uDE46-\uDEBF\uDED4-\uDEDF\uDEF4-\uDEFF\uDF57-\uDF5F\uDF79-\uDFFF]|\uD835[\uDC55\uDC9D\uDCA0\uDCA1\uDCA3\uDCA4\uDCA7\uDCA8\uDCAD\uDCBA\uDCBC\uDCC4\uDD06\uDD0B\uDD0C\uDD15\uDD1D\uDD3A\uDD3F\uDD45\uDD47-\uDD49\uDD51\uDEA6\uDEA7\uDFCC\uDFCD]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE8C-\uDFFF]|\uD837[\uDC00-\uDEFF\uDF1F-\uDF24\uDF2B-\uDFFF]|\uD838[\uDC00-\uDC2F\uDC6E-\uDCFF\uDD2D-\uDD36\uDD3E\uDD3F\uDD4A-\uDD4D\uDD50-\uDE8F\uDEAE-\uDEBF\uDEEC-\uDEEF\uDEFA-\uDEFE\uDF00-\uDFFF]|\uD839[\uDC00-\uDCCF\uDCEC-\uDCEF\uDCFA-\uDFDF\uDFE7\uDFEC\uDFEF\uDFFF]|\uD83A[\uDCC5\uDCC6\uDCD0-\uDCFF\uDD44-\uDD4A\uDD4C-\uDD4F\uDD5A-\uDD5D\uDD60-\uDFFF]|\uD83B[\uDC00-\uDC70\uDCB5-\uDD00\uDD3E-\uDDFF\uDE04\uDE20\uDE23\uDE25\uDE26\uDE28\uDE33\uDE38\uDE3A\uDE3C-\uDE41\uDE43-\uDE46\uDE48\uDE4A\uDE4C\uDE50\uDE53\uDE55\uDE56\uDE58\uDE5A\uDE5C\uDE5E\uDE60\uDE63\uDE65\uDE66\uDE6B\uDE73\uDE78\uDE7D\uDE7F\uDE8A\uDE9C-\uDEA0\uDEA4\uDEAA\uDEBC-\uDEEF\uDEF2-\uDFFF]|\uD83C[\uDC2C-\uDC2F\uDC94-\uDC9F\uDCAF\uDCB0\uDCC0\uDCD0\uDCF6-\uDCFF\uDDAE-\uDDE5\uDE03-\uDE0F\uDE3C-\uDE3F\uDE49-\uDE4F\uDE52-\uDE5F\uDE66-\uDEFF]|\uD83D[\uDED8-\uDEDB\uDEED-\uDEEF\uDEFD-\uDEFF\uDF77-\uDF7A\uDFDA-\uDFDF\uDFEC-\uDFEF\uDFF1-\uDFFF]|\uD83E[\uDC0C-\uDC0F\uDC48-\uDC4F\uDC5A-\uDC5F\uDC88-\uDC8F\uDCAE\uDCAF\uDCB2-\uDCFF\uDE54-\uDE5F\uDE6E\uDE6F\uDE7D-\uDE7F\uDE89-\uDE8F\uDEBE\uDEC6-\uDECD\uDEDC-\uDEDF\uDEE9-\uDEEF\uDEF9-\uDEFF\uDF93\uDFCB-\uDFEF\uDFFA-\uDFFF]|\uD869[\uDEE0-\uDEFF]|\uD86D[\uDF3A-\uDF3F]|\uD86E[\uDC1E\uDC1F]|\uD873[\uDEA2-\uDEAF]|\uD87A[\uDFE1-\uDFEF]|\uD87B[\uDE5E-\uDFFF]|\uD87E[\uDE1E-\uDFFF]|\uD884[\uDF4B-\uDF4F]|\uD888[\uDFB0-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])/g," ").split(D.join).join("").replace(/\s+/g," ").trim()};var eu=!1,nu=!1;function ru(){uu();var u=this["_"+U];u._mask;var D=u._tags,F=u.mask,t=u.state.n;if(!eu&&!nu)for(var e in D)y(D[e],t+"__tag--selected");y(F,t+="--focus"),y(F,t+="-tag")}function iu(u){uu();var D=this["_"+U],F=D._mask,t=D.mask,e=D.state,n=F.text,r=e.n;y(n,r+"__text--focus"),y(t,r+="--focus"),y(t,r+="-text"),D.fire("blur",[u])}function Eu(u){var D=this["_"+U],F=u.target,t=D.state.n+"__tag";k(F,t)||h(F,"."+t)||D.focus()}function au(u){var D=this,F=D["_"+U];F._tags;var t=F.state.n+"__tag--selected";T(D,t),W(D),Du(B(D))}function Cu(u){var D=this["_"+U],F=D._tags,t=D.state,e=t.n+"__tag--selected",n=[];for(var r in F)k(F[r],e)&&n.push(r);u.clipboardData.setData("text/plain",n.join(t.join)),D.fire("copy",[u,n]).focus(),P(u)}function su(u){var D=this["_"+U],F=D._mask,t=D._tags,e=D.state;F.input;var n=e.n+"__tag--selected",r=[];for(var i in t)k(t[i],n)&&(r.push(i),D.let(i));u.clipboardData.setData("text/plain",r.join(e.join)),D.fire("cut",[u,r]).focus(),P(u)}function ou(u){var D=this["_"+U],F=D._mask,t=D._tags,e=D.mask,n=D.self,r=D.state,i=F.hint,E=F.input,a=F.text,C=r.n;for(var s in t)y(t[s],C+"__tag--selected");T(a,C+"__text--focus"),T(e,C+="--focus"),T(e,C+="-text"),N((function(){return O(i,d(E,!1)?"":n.placeholder)}),1)(),D.focus().fire("focus",[u])}function Au(){this["_"+U].focus()}function fu(u){this["_"+U].fire("min.tags").focus(),P(u)}function cu(u){var D=this["_"+U];D._mask;var F=D.mask,t=D.state.n;T(F,t+="--focus"),T(F,t+="-tag"),D.fire("focus.tag",[u])}function lu(u){var D,F=this,t=u.key,e=eu=u.ctrlKey,n=nu=u.shiftKey,r=F["_"+U],i=r._mask,a=r._tags;r.mask;var C,o,A=r.state,f=i.text,c=g(F),l=v(F),p=A.n+"__tag--selected";if(n)T(F,p),Du(B(F)),M===t?(c&&(k(c,p)?y(F,p):T(c,p),W(c),Du(B(c))),D=!0):$===t&&(l&&f!==l&&(k(l,p)?y(F,p):T(l,p),W(l),Du(B(l))),D=!0);else if(e)if("a"===t){for(var h in a)W(a[h]),Du(B(a[h])),T(a[h],p);D=!0}else M===t?(c&&W(c),D=!0):$===t?(l&&f!==l?W(l):r.focus(),D=!0):Q!==t&&" "!==t||(q(F,p),k(F,p)?(W(F),Du(B(F))):Du(B(s(a).pop())),D=!0);else{var _=[];for(var d in a)k(a[d],p)&&_.push(d),F!==a[d]&&y(a[d],p);if(z===t)(C=s(a).shift())&&W(C),D=!0;else if(J===t)(o=s(a).pop())&&W(o),D=!0;else if(Q===t||" "===t)q(F,p),k(F,p)?(W(F),Du(B(F))):Du(B(s(a).pop())),D=!0;else if(M===t)c&&W(c),D=!0;else if($===t)l&&f!==l?W(l):r.focus(),D=!0;else if(G===t){if(r.let(F.title),E(_)>1)for(var m;m=_.pop();)c=a[m]&&g(a[m]),r.let(m);c?(W(c),Du(B(c))):r.focus(),D=!0}else if("Delete"===t){if(r.let(F.title),E(_)>1)for(var b;b=_.shift();)l=a[b]&&v(a[b]),r.let(b);l&&f!==l?(W(l),Du(B(l))):r.focus(),D=!0}else"Escape"!==t&&"Tab"!==t||(r.focus(),D=!0)}D&&P(u)}function Bu(){eu=nu=!1}function pu(D){var F=this,t=X(F),e=F["_"+U],n=e.state.escape;if("\n"===t&&(u("\n",n)||u(13,n))||"\t"===t&&(u("\t",n)||u(9,n))||u(t,n))return e.set(d(F).slice(0,-1)).focus().text="",P(D)}function vu(D){var F,e=this,n=D.key,r=D.keyCode,i=eu=D.ctrlKey,E=nu=D.shiftKey,a=e["_"+U],C=a._active,o=a._mask,A=a._tags;a.mask;var f,l,p=a.self,v=a.state,h=o.hint,g=v.n+"__tag--selected";if(escape=v.escape,!C)return P(D);if(Q===n&&(u("\n",escape)||u(13,escape))||"Tab"===n&&(u("\t",escape)||u(9,escape))||u(n,escape)||u(r,escape))return a.set(d(e)).focus().text="",P(D);N((function(){return O(h,d(e,!1)?"":p.placeholder)}),1)();var m,k=""===X(e),b=null===d(e,!1);if(E)(b||k)&&M===n&&(l=s(A).pop())&&(l&&(W(l),Du(B(l))),T(l,g),F=!0);else if(i)if("a"===n&&null===d(e,!1)&&null!==a.value){for(var x in A)W(A[x]),Du(B(A[x])),T(A[x],g);F=!0}else z===n?((f=s(A).shift())&&W(f),F=!0):J===n||M===n?((l=s(A).pop())&&W(l),F=!0):G===n&&((l=s(A).pop())&&a.let(l.title),a.focus(),F=!0);else if(Q===n){var y=_(p);if(y&&t(y.requestSubmit)){var j=(m="button:not([type]),button[type=submit],input[type=image],input[type=submit]",(y||c).querySelector(m));j?y.requestSubmit(j):y.requestSubmit()}F=!0}else b?z===n?((f=s(A).shift())&&W(f),F=!0):J===n||M===n?((l=s(A).pop())&&W(l),F=!0):G===n&&((l=s(A).pop())&&a.let(l.title),a.focus(),F=!0):k&&M===n&&((l=s(A).pop())&&W(l),F=!0);F&&P(D)}function hu(){eu=nu=!1}function _u(u){var D=this["_"+U],F=D._tags,t=D.state,e=t.n+"__tag--selected",n=!0,r=(u.clipboardData||l.clipboardData).getData("text")+"";for(var i in F)if(!k(F[i],e)){n=!1;break}n&&D.value&&D.value.split(t.join).forEach((function(u){return D.let(u,0)}));var E=r.split(t.join);E.forEach((function(u){return D.set(u,0)})),D.fire("paste",[u,E]).focus().fire("change"),P(u)}function gu(u){var D=this,F=D["_"+U],t=F._mask,e=F.self,n=F.state,r=t.hint,i=(u.clipboardData||l.clipboardData).getData("text")+"";(function(u,D){var F,t=l.getSelection();t.rangeCount&&((F=t.getRangeAt(0)).deleteContents(),F.insertNode(c.createTextNode(D)))})(0,i),O(r,d(D)?"":e.placeholder),N((function(){if(i=d(D),F.text="",i){var t=i.split(n.join);t.forEach((function(u){return F.set(u,0)})),F.fire("paste",[u,t]).fire("change")}}),1)(),P(u)}function du(u){var D=this,F=D["_"+U],t=F._active,e=F._mask,n=F._tags,r=F.state,i=e.text,a=r.n+"__tag--selected";if(t){if(W(D),q(D,a),eu);else if(nu){uu();var C,o=h(D),A=(d="."+a,(o||c).querySelectorAll(d)),f=A[0],l=A[E(A)-1];if(f!==l)for(;(C=v(f))&&i!==C&&f!==l;)T(f=C,a)}else{uu();var p=2===u.button,_=0;for(var g in n)k(n[g],a)&&++_,D===n[g]||p||y(n[g],a);_>0&&T(D,a)}var d;k(D,a)?(W(D),Du(B(D))):Du(s(n).pop()),F.fire("touch.tag",[u]),P(u),function(u){u&&u.stopPropagation()}(u)}}function mu(u){var D=h(this),F=D["_"+U];F._mask.input,K("click",this,mu),F.let(D.title),F.focus(),P(u)}function ku(u){this["_"+U].let().fire("reset",[u])}function bu(u){var D=this["_"+U],F=D._tags,t=D.state;return a(F)<t.min?(D.fire("min.tags").focus(),P(u)):D.fire("submit",[u])}return tu.attach=function(u,F){var e=this;if(u=u||e.self,F&&i(F)&&(F={join:F}),F=A({},e.state,F||{}),k(u,F.n+"__self"))return e;(function(u){return u.required})(u)&&!F.min&&(F.min=1),e._active=!Z(u)&&!function(u){return u.readOnly}(u),e._tags={},e._value=Y(u)||null,e.self=u,e.state=F;var a=F.n,C=_(u),s=R("div",{class:a,tabindex:!Z(u)&&-1});e.mask=s;var o,f,c=R("span",{class:a+"__tags"}),l=R("span",{class:a+"__text"}),B=R("span",{contenteditable:!Z(u)&&"",spellcheck:"false"}),p=R("span",u.placeholder+"");S(s,c),S(c,l),S(l,B),S(l,p),T(u,a+"__self"),f=s,h(o=u).insertBefore(f,v(o,!0)),C&&(C["_"+U]=e,I("reset",C,ku),I("submit",C,bu)),I("blur",B,iu),I("click",s,Eu),I("focus",u,Au),I("focus",B,ou),I("input",B,pu),I("invalid",u,fu),I("keydown",B,vu),I("keyup",B,hu),I("paste",B,gu),u.tabIndex=-1,s["_"+U]=e,B["_"+U]=e;var g={};if(g.hint=p,g.input=B,g.of=u,g.self=s,g.tags=c,g.text=l,e._mask=g,e._value&&e._value.split(F.join).forEach((function(u){return e.set(u,0,1)})),r(F)&&D(F.with))for(var d=0,m=E(F.with);d<m;++d){var b=F.with[d];i(b)&&(b=Fu[b]),t(b)?b.call(e,u,F):n(b)&&t(b.attach)&&b.attach.call(e,u,F)}return e},tu.blur=function(){uu();var u=this._mask,D=this._tags,F=u.input;for(var t in D)D[t].blur();return F.blur()},tu.detach=function(){var u=this,F=u._mask,e=u.mask,r=u.self,a=u.state,C=F.input;if(!k(r,a.n+"__self"))return u;var s=_(r);if(u._active=!1,s&&(K("reset",s,ku),K("submit",s,bu)),K("blur",C,iu),K("click",e,Eu),K("focus",C,ou),K("focus",r,Au),K("input",C,pu),K("invalid",r,fu),K("keydown",C,vu),K("keyup",C,hu),K("paste",C,gu),D(a.with))for(var o=0,A=E(a.with);o<A;++o){var f=a.with[o];i(f)&&(f=Fu[f]),n(f)&&t(f.detach)&&f.detach.call(u,r,a)}return r.tabIndex=null,y(r,a.n+"__self"),j(e),u._mask={of:r},u.mask=null,u},tu.focus=function(u){var D=this._mask.input;return D&&(W(D),Du(D,u)),this},tu.get=function(u){var D=this,F=D._active,t=D._tags;return!!F&&(D.fire("get.tag",[u]),t[u]?C(t).indexOf(u):null)},tu.let=function(u,D){void 0===D&&(D=!0);var t=this,e=t._active,n=t._tags,r=t._value,i=t.self,E=t.state;if(!e)return t;if(!F(u))return t.value&&t.value.split(E.join).forEach((function(u){return t.let(u,0)})),r.split(E.join).forEach((function(u){return t.set(u,0)})),t.fire("change");if(a(n)<E.min)return t.fire("min.tags",[u]);if(!n[u])return t;var s=n[u];p(s,0);var o=p(s,1);return K("blur",s,ru),K("contextmenu",s,au),K("copy",s,Cu),K("cut",s,su),K("focus",s,cu),K("keydown",s,lu),K("keyup",s,Bu),K("mousedown",s,du),K("mousedown",o,mu),K("paste",s,_u),K("touchstart",s,du),K("touchstart",o,mu),j(s),delete t._tags[u],i.value=C(t._tags).join(E.join),t.fire("let.tag",[u]),D&&t.fire("change",[u]),t},tu.set=function(u,D,F){void 0===D&&(D=!0);var e=this,n=e._active,r=e._filter,E=e._mask,s=e._tags,o=e.self,A=e.state,f=E.text,c=A.pattern,l=A.n;if(!n&&!F)return e;if(a(s)>=A.max)return e.fire("max.tags",[u]);if(t(r)&&(u=r.call(e,u)),e.fire("set.tag",[u]),""===u||i(c)&&!H(c).test(u))return e.fire("not.tag",[u]);if(s[u])return e.fire("has.tag",[u]);e.fire("is.tag",[u]);var B,p,v=R("span",{class:l+="__tag",tabindex:!!n&&-1,title:u}),_=R("span",u.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;")),g=R("span",{class:l+="-x",tabindex:-1});return n&&(I("blur",v,ru),I("contextmenu",v,au),I("copy",v,Cu),I("cut",v,su),I("focus",v,cu),I("keydown",v,lu),I("keyup",v,Bu),I("mousedown",v,du),I("mousedown",g,mu),I("paste",v,_u),I("touchstart",v,du),I("touchstart",g,mu),v["_"+U]=e),S(v,_),S(v,g),p=v,h(B=f).insertBefore(p,B),e._tags[u]=v,o.value=C(e._tags).join(A.join),e.fire("set.tag",[u]),D&&e.fire("change",[u]),e},Fu}));