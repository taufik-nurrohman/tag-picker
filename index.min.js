/*!
 *
 * The MIT License (MIT)
 *
 * Copyright © 2024 Taufik Nurrohman <https://github.com/taufik-nurrohman>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the “Software”), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED “AS IS”, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */
!function(u,D){"object"==typeof exports&&"undefined"!=typeof module?module.exports=D():"function"==typeof define&&define.amd?define(D):(u="undefined"!=typeof globalThis?globalThis:u||self).TagPicker=D()}(this,(function(){"use strict";var u=function(u){return Array.isArray(u)},D=function(u){return void 0!==u},F=function(u){return"function"==typeof u},t=function(u,D){return u&&n(D)&&u instanceof D},e=function(u,D){return void 0===D&&(D=!0),"object"==typeof u&&(!D||t(u,Object))},n=function(u){return D(u)&&!function(u){return null===u}(u)},r=function(u){return"string"==typeof u},E=function(u){return u.length},i=function(u){return E(C(u))},C=function(u){return Object.keys(u)},a=function(u){return Object.values(u)},A=function D(F){if(u(F))return F.map((function(u){return D(u)}));if(function(u){return/^-?(?:\d*.)?\d+$/.test(u+"")}(F))return function(u,D){return void 0===D&&(D=10),D?parseInt(u,D):parseFloat(u)}(F);if(e(F)){for(var t in F)F[t]=D(F[t]);return F}return"false"!==F&&("null"===F?null:"true"===F||F)},s=function D(){for(var F=arguments.length,t=Array(F),r=0;r<F;r++)t[r]=arguments[r];for(var i,C=t.shift(),a=0,A=E(t);a<A;++a)for(var s in t[a])if(n(C[s]))if(u(C[s])&&u(t[a][s])){C[s]=[].concat(C[s]);for(var o=0,f=E(t[a][s]);o<f;++o)i=t[a][s][o],-1===C[s].indexOf(i)&&C[s].push(t[a][s][o])}else e(C[s])&&e(t[a][s])?C[s]=D({},C[s],t[a][s]):C[s]=t[a][s];else C[s]=t[a][s];return C},o=function D(F){if(u(F))return F.map((function(u){return D(F)}));if(e(F)){for(var t in F)F[t]=D(F[t]);return F}return!1===F?"false":null===F?"null":!0===F?"true":""+F},f=document,c=window,l=function(u,D,F){if(void 0===F&&(F=!0),!m(u,D))return null;var t=u.getAttribute(D);return F?A(t):t},B=function(u){return u.firstElementChild||null},p=function(u,D){var F=u.children;return"number"==typeof D?F[D]||null:F||[]},v=function(u,D){return u["next"+(D?"":"Element")+"Sibling"]||null},h=function(u,D){return D?u.closest(D)||null:u.parentNode||null},_=function(u){var D="form";return b(u,D)&&D===function(u){return(u&&u.nodeName||"").toLowerCase()||null}(u[D])?u[D]:h(u,D)},g=function(u,D){return u.previousElementSibling||null},d=function(u,D){void 0===D&&(D=!0);var F="textContent";if(!b(u,F))return!1;var t=u[F];return""!==(t=D?t.trim():t)?t:null},m=function(u,D){return u.hasAttribute(D)},k=function(u,D){return u.classList.contains(D)},b=function(u,D){return D in u},x=function(u,D){return u.removeAttribute(D),u},y=function(u,D){return u.classList.remove(D),u},j=function(u){var D=h(u);return u.remove(),D},w=function(u,D,F){return!0===F&&(F=D),u.setAttribute(D,o(F)),u},S=function(u,D){return u.append(D),D},L=function(u,D){return u.classList.add(D),u},R=function(u,D,F){return u=r(u)?f.createElement(u):u,e(D)&&(F=D,D=!1),r(D)&&T(u,D),e(F)&&function(u,D){var F;for(var t in D)(F=D[t])||""===F||0===F?w(u,t,F):x(u,t)}(u,F),u},T=function(u,D,F){if(void 0===F&&(F=!0),null===D)return u;var t="innerHTML";return b(u,t)&&(u[t]=F?D.trim():D),u},O=function(u,D,F){if(void 0===F&&(F=!0),null===D)return u;var t="textContent";return b(u,t)&&(u[t]=F?D.trim():D),u},N=function(u,D,F){return u.classList.toggle(D,F),u},q=function(u,D){return function(){var F=arguments,t=this;setTimeout((function(){return u.apply(t,F)}),D)}};var K=function(u,D,F){D.removeEventListener(u,F)},P=function(u){return u&&u.preventDefault()},I=function(u,D,F,t){void 0===t&&(t=!1),D.addEventListener(u,F,t)},H=function(u,D){return function(u){return t(u,RegExp)}(u)?u:RegExp(u,n(D)?D:"g")},M="ArrowLeft",$="ArrowRight",z="Home",G="Backspace",J="End",Q="Enter",U="TagPicker";function V(u,D,F){Object.defineProperty(u,D,F)}function W(u){u.focus()}function X(u){var D,F=c.getSelection();if(F.rangeCount)return(D=F.getRangeAt(0).cloneRange()).collapse(!0),D.setStart(u,0),(D+"").slice(-1)}function Y(u){return u.disabled}function Z(u){f.getSelection().removeAllRanges()}function uu(u){var D=f.getSelection();Z();var F=f.createRange();F.selectNodeContents(u),D.addRange(F)}function Du(u,D){var F=this;if(!u)return F;if(!t(F,Du))return new Du(u,D);u["_"+U]=function(u,D){return(D=D||u).fire=function(u,D){var F=this,t=F.hooks;return n(t[u])?(t[u].forEach((function(u){return u.apply(F,D)})),F):F},D.off=function(u,D){var F=this,t=F.hooks;if(!n(u))return t={},F;if(n(t[u]))if(n(D)){var e=t[u].length;if(0===e)delete t[u];else for(var r=0;r<e;++r)if(D===t[u][r]){t[u].splice(r,1);break}}else delete t[u];return F},D.on=function(u,D){var F=this.hooks;return n(F[u])||(F[u]=[]),n(D)&&F[u].push(D),this},u.hooks={},u}(F,Du.prototype);var E=s({},Du.state,r(D)?{join:D}:D||{});return e(D)&&D.escape&&(E.escape=D.escape),F.attach(u,E)}Du.state={escape:[","],join:", ",max:9999,min:0,n:"tag-picker",pattern:null,with:[]},Du.version="4.0.0",V(Du,"name",{value:U});var Fu=Du.prototype;V(Fu,"text",{get:function(){return d(this._mask.input)},set:function(u){var D=this._mask,F=this.self,t=D.hint,e=D.input;O(t,""===(u+="")?F.placeholder:""),O(e,u)}}),V(Fu,"value",{get:function(){var u=this.self.value;return""===u?null:u},set:function(u){var D=this,F=D.state;u.split(F.join).forEach((function(u){return D.set(u)}))}}),Fu._filter=function(u){var D=this.state;return(u||"").replace(/(?:[\0- \x7F-\xA0\xAD\u0300-\u036F\u0378\u0379\u0380-\u0383\u038B\u038D\u03A2\u0483-\u0489\u0530\u0557\u0558\u058B\u058C\u0590-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7-\u05CF\u05EB-\u05EE\u05F5-\u0605\u0610-\u061A\u061C\u064B-\u065F\u0670\u06D6-\u06DD\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u070E\u070F\u0711\u0730-\u074C\u07A6-\u07B0\u07B2-\u07BF\u07EB-\u07F3\u07FB-\u07FD\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082F\u083F\u0859-\u085D\u085F\u086B-\u086F\u088F-\u089F\u08CA-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0981-\u0984\u098D\u098E\u0991\u0992\u09A9\u09B1\u09B3-\u09B5\u09BA-\u09BC\u09BE-\u09CD\u09CF-\u09DB\u09DE\u09E2-\u09E5\u09FE-\u0A04\u0A0B-\u0A0E\u0A11\u0A12\u0A29\u0A31\u0A34\u0A37\u0A3A-\u0A58\u0A5D\u0A5F-\u0A65\u0A70\u0A71\u0A75\u0A77-\u0A84\u0A8E\u0A92\u0AA9\u0AB1\u0AB4\u0ABA-\u0ABC\u0ABE-\u0ACF\u0AD1-\u0ADF\u0AE2-\u0AE5\u0AF2-\u0AF8\u0AFA-\u0B04\u0B0D\u0B0E\u0B11\u0B12\u0B29\u0B31\u0B34\u0B3A-\u0B3C\u0B3E-\u0B5B\u0B5E\u0B62-\u0B65\u0B78-\u0B82\u0B84\u0B8B-\u0B8D\u0B91\u0B96-\u0B98\u0B9B\u0B9D\u0BA0-\u0BA2\u0BA5-\u0BA7\u0BAB-\u0BAD\u0BBA-\u0BCF\u0BD1-\u0BE5\u0BFB-\u0C04\u0C0D\u0C11\u0C29\u0C3A-\u0C3C\u0C3E-\u0C57\u0C5B\u0C5C\u0C5E\u0C5F\u0C62-\u0C65\u0C70-\u0C76\u0C81-\u0C83\u0C8D\u0C91\u0CA9\u0CB4\u0CBA-\u0CBC\u0CBE-\u0CDC\u0CDF\u0CE2-\u0CE5\u0CF0\u0CF3-\u0D03\u0D0D\u0D11\u0D3B\u0D3C\u0D3E-\u0D4D\u0D50-\u0D53\u0D57\u0D62-\u0D65\u0D80-\u0D84\u0D97-\u0D99\u0DB2\u0DBC\u0DBE\u0DBF\u0DC7-\u0DE5\u0DF0-\u0DF3\u0DF5-\u0E00\u0E31\u0E34-\u0E3E\u0E47-\u0E4E\u0E5C-\u0E80\u0E83\u0E85\u0E8B\u0EA4\u0EA6\u0EB1\u0EB4-\u0EBC\u0EBE\u0EBF\u0EC5\u0EC7-\u0ECF\u0EDA\u0EDB\u0EE0-\u0EFF\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F48\u0F6D-\u0F84\u0F86\u0F87\u0F8D-\u0FBD\u0FC6\u0FCD\u0FDB-\u0FFF\u102B-\u103E\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109D\u10C6\u10C8-\u10CC\u10CE\u10CF\u1249\u124E\u124F\u1257\u1259\u125E\u125F\u1289\u128E\u128F\u12B1\u12B6\u12B7\u12BF\u12C1\u12C6\u12C7\u12D7\u1311\u1316\u1317\u135B-\u135F\u137D-\u137F\u139A-\u139F\u13F6\u13F7\u13FE\u13FF\u1680\u169D-\u169F\u16F9-\u16FF\u1712-\u171E\u1732-\u1734\u1737-\u173F\u1752-\u175F\u176D\u1771-\u177F\u17B4-\u17D3\u17DD-\u17DF\u17EA-\u17EF\u17FA-\u17FF\u180B-\u180F\u181A-\u181F\u1879-\u187F\u1885\u1886\u18A9\u18AB-\u18AF\u18F6-\u18FF\u191F-\u193F\u1941-\u1943\u196E\u196F\u1975-\u197F\u19AC-\u19AF\u19CA-\u19CF\u19DB-\u19DD\u1A17-\u1A1D\u1A55-\u1A7F\u1A8A-\u1A8F\u1A9A-\u1A9F\u1AAE-\u1B04\u1B34-\u1B44\u1B4D-\u1B4F\u1B6B-\u1B73\u1B7F-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BFB\u1C24-\u1C3A\u1C4A-\u1C4C\u1C89-\u1C8F\u1CBB\u1CBC\u1CC8-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF4\u1CF7-\u1CF9\u1CFB-\u1CFF\u1DC0-\u1DFF\u1F16\u1F17\u1F1E\u1F1F\u1F46\u1F47\u1F4E\u1F4F\u1F58\u1F5A\u1F5C\u1F5E\u1F7E\u1F7F\u1FB5\u1FC5\u1FD4\u1FD5\u1FDC\u1FF0\u1FF1\u1FF5\u1FFF-\u200F\u2028-\u202F\u205F-\u206F\u2072\u2073\u208F\u209D-\u209F\u20C1-\u20FF\u218C-\u218F\u2427-\u243F\u244B-\u245F\u2B74\u2B75\u2B96\u2CEF-\u2CF1\u2CF4-\u2CF8\u2D26\u2D28-\u2D2C\u2D2E\u2D2F\u2D68-\u2D6E\u2D71-\u2D7F\u2D97-\u2D9F\u2DA7\u2DAF\u2DB7\u2DBF\u2DC7\u2DCF\u2DD7\u2DDF-\u2DFF\u2E5E-\u2E7F\u2E9A\u2EF4-\u2EFF\u2FD6-\u2FEF\u3000\u302A-\u302F\u3040\u3097-\u309A\u3100-\u3104\u3130\u318F\u31E4-\u31EE\u321F\uA48D-\uA48F\uA4C7-\uA4CF\uA62C-\uA63F\uA66F-\uA672\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA6F8-\uA6FF\uA7CB-\uA7CF\uA7D2\uA7D4\uA7DA-\uA7F1\uA802\uA806\uA80B\uA823-\uA827\uA82C-\uA82F\uA83A-\uA83F\uA878-\uA881\uA8B4-\uA8CD\uA8DA-\uA8F1\uA8FF\uA926-\uA92D\uA947-\uA95E\uA97D-\uA983\uA9B3-\uA9C0\uA9CE\uA9DA-\uA9DD\uA9E5\uA9FF\uAA29-\uAA3F\uAA43\uAA4C-\uAA4F\uAA5A\uAA5B\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAC3-\uAADA\uAAEB-\uAAEF\uAAF5-\uAB00\uAB07\uAB08\uAB0F\uAB10\uAB17-\uAB1F\uAB27\uAB2F\uAB6C-\uAB6F\uABE3-\uABEA\uABEC-\uABEF\uABFA-\uABFF\uD7A4-\uD7AF\uD7C7-\uD7CA\uD7FC-\uD7FF\uE000-\uF8FF\uFA6E\uFA6F\uFADA-\uFAFF\uFB07-\uFB12\uFB18-\uFB1C\uFB1E\uFB37\uFB3D\uFB3F\uFB42\uFB45\uFBC3-\uFBD2\uFD90\uFD91\uFDC8-\uFDCE\uFDD0-\uFDEF\uFE00-\uFE0F\uFE1A-\uFE2F\uFE53\uFE67\uFE6C-\uFE6F\uFE75\uFEFD-\uFF00\uFFBF-\uFFC1\uFFC8\uFFC9\uFFD0\uFFD1\uFFD8\uFFD9\uFFDD-\uFFDF\uFFE7\uFFEF-\uFFFB\uFFFE\uFFFF]|\uD800[\uDC0C\uDC27\uDC3B\uDC3E\uDC4E\uDC4F\uDC5E-\uDC7F\uDCFB-\uDCFF\uDD03-\uDD06\uDD34-\uDD36\uDD8F\uDD9D-\uDD9F\uDDA1-\uDDCF\uDDFD-\uDE7F\uDE9D-\uDE9F\uDED1-\uDEE0\uDEFC-\uDEFF\uDF24-\uDF2C\uDF4B-\uDF4F\uDF76-\uDF7F\uDF9E\uDFC4-\uDFC7\uDFD6-\uDFFF]|\uD801[\uDC9E\uDC9F\uDCAA-\uDCAF\uDCD4-\uDCD7\uDCFC-\uDCFF\uDD28-\uDD2F\uDD64-\uDD6E\uDD7B\uDD8B\uDD93\uDD96\uDDA2\uDDB2\uDDBA\uDDBD-\uDDFF\uDF37-\uDF3F\uDF56-\uDF5F\uDF68-\uDF7F\uDF86\uDFB1\uDFBB-\uDFFF]|\uD802[\uDC06\uDC07\uDC09\uDC36\uDC39-\uDC3B\uDC3D\uDC3E\uDC56\uDC9F-\uDCA6\uDCB0-\uDCDF\uDCF3\uDCF6-\uDCFA\uDD1C-\uDD1E\uDD3A-\uDD3E\uDD40-\uDD7F\uDDB8-\uDDBB\uDDD0\uDDD1\uDE01-\uDE0F\uDE14\uDE18\uDE36-\uDE3F\uDE49-\uDE4F\uDE59-\uDE5F\uDEA0-\uDEBF\uDEE5-\uDEEA\uDEF7-\uDEFF\uDF36-\uDF38\uDF56\uDF57\uDF73-\uDF77\uDF92-\uDF98\uDF9D-\uDFA8\uDFB0-\uDFFF]|\uD803[\uDC49-\uDC7F\uDCB3-\uDCBF\uDCF3-\uDCF9\uDD24-\uDD2F\uDD3A-\uDE5F\uDE7F\uDEAA-\uDEAC\uDEAE\uDEAF\uDEB2-\uDEFF\uDF28-\uDF2F\uDF46-\uDF50\uDF5A-\uDF6F\uDF82-\uDF85\uDF8A-\uDFAF\uDFCC-\uDFDF\uDFF7-\uDFFF]|\uD804[\uDC00-\uDC02\uDC38-\uDC46\uDC4E-\uDC51\uDC70\uDC73\uDC74\uDC76-\uDC82\uDCB0-\uDCBA\uDCBD\uDCC2-\uDCCF\uDCE9-\uDCEF\uDCFA-\uDD02\uDD27-\uDD35\uDD45\uDD46\uDD48-\uDD4F\uDD73\uDD77-\uDD82\uDDB3-\uDDC0\uDDC9-\uDDCC\uDDCE\uDDCF\uDDE0\uDDF5-\uDDFF\uDE12\uDE2C-\uDE37\uDE3E\uDE41-\uDE7F\uDE87\uDE89\uDE8E\uDE9E\uDEAA-\uDEAF\uDEDF-\uDEEF\uDEFA-\uDF04\uDF0D\uDF0E\uDF11\uDF12\uDF29\uDF31\uDF34\uDF3A-\uDF3C\uDF3E-\uDF4F\uDF51-\uDF5C\uDF62-\uDFFF]|\uD805[\uDC35-\uDC46\uDC5C\uDC5E\uDC62-\uDC7F\uDCB0-\uDCC3\uDCC8-\uDCCF\uDCDA-\uDD7F\uDDAF-\uDDC0\uDDDC-\uDDFF\uDE30-\uDE40\uDE45-\uDE4F\uDE5A-\uDE5F\uDE6D-\uDE7F\uDEAB-\uDEB7\uDEBA-\uDEBF\uDECA-\uDEFF\uDF1B-\uDF2F\uDF47-\uDFFF]|\uD806[\uDC2C-\uDC3A\uDC3C-\uDC9F\uDCF3-\uDCFE\uDD07\uDD08\uDD0A\uDD0B\uDD14\uDD17\uDD30-\uDD3E\uDD40\uDD42\uDD43\uDD47-\uDD4F\uDD5A-\uDD9F\uDDA8\uDDA9\uDDD1-\uDDE0\uDDE4-\uDDFF\uDE01-\uDE0A\uDE33-\uDE39\uDE3B-\uDE3E\uDE47-\uDE4F\uDE51-\uDE5B\uDE8A-\uDE99\uDEA3-\uDEAF\uDEF9-\uDEFF\uDF0A-\uDFFF]|\uD807[\uDC09\uDC2F-\uDC3F\uDC46-\uDC4F\uDC6D-\uDC6F\uDC90-\uDCFF\uDD07\uDD0A\uDD31-\uDD45\uDD47-\uDD4F\uDD5A-\uDD5F\uDD66\uDD69\uDD8A-\uDD97\uDD99-\uDD9F\uDDAA-\uDEDF\uDEF3-\uDEF6\uDEF9-\uDF01\uDF03\uDF11\uDF34-\uDF42\uDF5A-\uDFAF\uDFB1-\uDFBF\uDFF2-\uDFFE]|\uD808[\uDF9A-\uDFFF]|\uD809[\uDC6F\uDC75-\uDC7F\uDD44-\uDFFF]|[\uD80A\uD80E-\uD810\uD812-\uD819\uD824-\uD82A\uD82D\uD82E\uD830-\uD832\uD83F\uD87C\uD87D\uD87F\uD889-\uDBFF][\uDC00-\uDFFF]|\uD80B[\uDC00-\uDF8F\uDFF3-\uDFFF]|\uD80D[\uDC30-\uDC40\uDC47-\uDFFF]|\uD811[\uDE47-\uDFFF]|\uD81A[\uDE39-\uDE3F\uDE5F\uDE6A-\uDE6D\uDEBF\uDECA-\uDECF\uDEEE-\uDEF4\uDEF6-\uDEFF\uDF30-\uDF36\uDF46-\uDF4F\uDF5A\uDF62\uDF78-\uDF7C\uDF90-\uDFFF]|\uD81B[\uDC00-\uDE3F\uDE9B-\uDEFF\uDF4B-\uDF4F\uDF51-\uDF92\uDFA0-\uDFDF\uDFE4-\uDFFF]|\uD821[\uDFF8-\uDFFF]|\uD823[\uDCD6-\uDCFF\uDD09-\uDFFF]|\uD82B[\uDC00-\uDFEF\uDFF4\uDFFC\uDFFF]|\uD82C[\uDD23-\uDD31\uDD33-\uDD4F\uDD53\uDD54\uDD56-\uDD63\uDD68-\uDD6F\uDEFC-\uDFFF]|\uD82F[\uDC6B-\uDC6F\uDC7D-\uDC7F\uDC89-\uDC8F\uDC9A\uDC9B\uDC9D\uDC9E\uDCA0-\uDFFF]|\uD833[\uDC00-\uDF4F\uDFC4-\uDFFF]|\uD834[\uDCF6-\uDCFF\uDD27\uDD28\uDD65-\uDD69\uDD6D-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDDEB-\uDDFF\uDE42-\uDE44\uDE46-\uDEBF\uDED4-\uDEDF\uDEF4-\uDEFF\uDF57-\uDF5F\uDF79-\uDFFF]|\uD835[\uDC55\uDC9D\uDCA0\uDCA1\uDCA3\uDCA4\uDCA7\uDCA8\uDCAD\uDCBA\uDCBC\uDCC4\uDD06\uDD0B\uDD0C\uDD15\uDD1D\uDD3A\uDD3F\uDD45\uDD47-\uDD49\uDD51\uDEA6\uDEA7\uDFCC\uDFCD]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE8C-\uDFFF]|\uD837[\uDC00-\uDEFF\uDF1F-\uDF24\uDF2B-\uDFFF]|\uD838[\uDC00-\uDC2F\uDC6E-\uDCFF\uDD2D-\uDD36\uDD3E\uDD3F\uDD4A-\uDD4D\uDD50-\uDE8F\uDEAE-\uDEBF\uDEEC-\uDEEF\uDEFA-\uDEFE\uDF00-\uDFFF]|\uD839[\uDC00-\uDCCF\uDCEC-\uDCEF\uDCFA-\uDFDF\uDFE7\uDFEC\uDFEF\uDFFF]|\uD83A[\uDCC5\uDCC6\uDCD0-\uDCFF\uDD44-\uDD4A\uDD4C-\uDD4F\uDD5A-\uDD5D\uDD60-\uDFFF]|\uD83B[\uDC00-\uDC70\uDCB5-\uDD00\uDD3E-\uDDFF\uDE04\uDE20\uDE23\uDE25\uDE26\uDE28\uDE33\uDE38\uDE3A\uDE3C-\uDE41\uDE43-\uDE46\uDE48\uDE4A\uDE4C\uDE50\uDE53\uDE55\uDE56\uDE58\uDE5A\uDE5C\uDE5E\uDE60\uDE63\uDE65\uDE66\uDE6B\uDE73\uDE78\uDE7D\uDE7F\uDE8A\uDE9C-\uDEA0\uDEA4\uDEAA\uDEBC-\uDEEF\uDEF2-\uDFFF]|\uD83C[\uDC2C-\uDC2F\uDC94-\uDC9F\uDCAF\uDCB0\uDCC0\uDCD0\uDCF6-\uDCFF\uDDAE-\uDDE5\uDE03-\uDE0F\uDE3C-\uDE3F\uDE49-\uDE4F\uDE52-\uDE5F\uDE66-\uDEFF]|\uD83D[\uDED8-\uDEDB\uDEED-\uDEEF\uDEFD-\uDEFF\uDF77-\uDF7A\uDFDA-\uDFDF\uDFEC-\uDFEF\uDFF1-\uDFFF]|\uD83E[\uDC0C-\uDC0F\uDC48-\uDC4F\uDC5A-\uDC5F\uDC88-\uDC8F\uDCAE\uDCAF\uDCB2-\uDCFF\uDE54-\uDE5F\uDE6E\uDE6F\uDE7D-\uDE7F\uDE89-\uDE8F\uDEBE\uDEC6-\uDECD\uDEDC-\uDEDF\uDEE9-\uDEEF\uDEF9-\uDEFF\uDF93\uDFCB-\uDFEF\uDFFA-\uDFFF]|\uD869[\uDEE0-\uDEFF]|\uD86D[\uDF3A-\uDF3F]|\uD86E[\uDC1E\uDC1F]|\uD873[\uDEA2-\uDEAF]|\uD87A[\uDFE1-\uDFEF]|\uD87B[\uDE5E-\uDFFF]|\uD87E[\uDE1E-\uDFFF]|\uD884[\uDF4B-\uDF4F]|\uD888[\uDFB0-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])/g," ").split(D.join).join("").replace(/\s+/g," ").trim()};var tu=!1,eu=!1;function nu(){Z();var u=this["_"+U];u._mask;var D=u._tags,F=u.mask,t=u.state.n;if(!tu&&!eu)for(var e in D)y(D[e],t+"__tag--selected");y(F,t+="--focus"),y(F,t+="-tag")}function ru(u){Z();var D=this["_"+U],F=D._mask,t=D.mask,e=D.state,n=F.text,r=e.n;y(n,r+"__text--focus"),y(t,r+="--focus"),y(t,r+="-text")}function Eu(u){var D=this["_"+U],F=u.target,t=D.state.n+"__tag";k(F,t)||h(F,"."+t)||D.focus()}function iu(u){var D=this,F=D["_"+U];F._tags;var t=F.state.n+"__tag--selected";L(D,t),W(D),uu(B(D))}function Cu(u){var D=this["_"+U],F=D._tags,t=D.state,e=t.n+"__tag--selected",n=[];for(var r in F)k(F[r],e)&&n.push(r);u.clipboardData.setData("text/plain",n.join(t.join)),D.fire("copy",[u]).focus(),P(u)}function au(u){var D=this["_"+U],F=D._mask,t=D._tags,e=D.state;F.input;var n=e.n+"__tag--selected",r=[];for(var E in t)k(t[E],n)&&(r.push(E),D.let(E));u.clipboardData.setData("text/plain",r.join(e.join)),D.fire("cut",[u]).focus(),P(u)}function Au(){var u=this["_"+U],D=u._mask,F=u._tags,t=u.mask,e=u.self,n=u.state,r=D.hint,E=D.input,i=D.text,C=n.n;for(var a in F)y(F[a],C+"__tag--selected");L(i,C+"__text--focus"),L(t,C+="--focus"),L(t,C+="-text"),q((function(){return O(r,d(E,!1)?"":e.placeholder)}),1)(),u.focus()}function su(){this["_"+U].focus()}function ou(u){var D=this["_"+U];D._mask;var F=D.mask,t=D.state.n;L(F,t+="--focus"),L(F,t+="-tag"),D.fire("focus.tag",[u])}function fu(u){var D,F=this,t=u.key,e=tu=u.ctrlKey,n=eu=u.shiftKey,r=F["_"+U],i=r._mask,C=r._tags;r.mask;var A,s,o=r.state,f=i.text,c=g(F),l=v(F),p=o.n+"__tag--selected";if(n)L(F,p),uu(B(F)),M===t?(c&&(k(c,p)?y(F,p):L(c,p),W(c),uu(B(c))),D=!0):$===t&&(l&&f!==l&&(k(l,p)?y(F,p):L(l,p),W(l),uu(B(l))),D=!0);else if(e)if("a"===t){for(var h in C)W(C[h]),uu(B(C[h])),L(C[h],p);D=!0}else M===t?(c&&W(c),D=!0):$===t?(l&&f!==l?W(l):r.focus(),D=!0):Q!==t&&" "!==t||(N(F,p),k(F,p)?(W(F),uu(B(F))):uu(B(a(C).pop())),D=!0);else{var _=[];for(var d in C)k(C[d],p)&&_.push(d),F!==C[d]&&y(C[d],p);if(z===t)(A=a(C).shift())&&W(A),D=!0;else if(J===t)(s=a(C).pop())&&W(s),D=!0;else if(Q===t||" "===t)N(F,p),k(F,p)?(W(F),uu(B(F))):uu(B(a(C).pop())),D=!0;else if(M===t)c&&W(c),D=!0;else if($===t)l&&f!==l?W(l):r.focus(),D=!0;else if(G===t){if(r.let(F.title),E(_)>1)for(var m;m=_.pop();)c=C[m]&&g(C[m]),r.let(m);c?(W(c),uu(B(c))):r.focus(),D=!0}else if("Delete"===t){if(r.let(F.title),E(_)>1)for(var b;b=_.shift();)l=C[b]&&v(C[b]),r.let(b);l&&f!==l?(W(l),uu(B(l))):r.focus(),D=!0}else"Escape"!==t&&"Tab"!==t||(r.focus(),D=!0)}D&&P(u)}function cu(){tu=eu=!1}function lu(u){var D=this,F=X(D),t=D["_"+U];if(t.state.escape.includes(F))return t.set(d(D).slice(0,-1)).focus().text="",P(u)}function Bu(u){var D,t=this,e=u.key,n=u.keyCode,r=tu=u.ctrlKey,E=eu=u.shiftKey,i=t["_"+U],C=i._active,A=i._mask,s=i._tags;i.mask;var o,c,l=i.self,p=i.state,v=A.hint,h=p.n+"__tag--selected";if(escape=p.escape,!C)return P(u);if(escape.includes(e)||escape.includes(n))return i.set(d(t)).focus().text="",P(u);q((function(){return O(v,d(t,!1)?"":l.placeholder)}),1)();var g,m=""===X(t),k=null===d(t,!1);if(E)(k||m)&&M===e&&(c=a(s).pop())&&(c&&(W(c),uu(B(c))),L(c,h),D=!0);else if(r)if("a"===e&&null===d(t,!1)&&null!==i.value){for(var b in s)W(s[b]),uu(B(s[b])),L(s[b],h);D=!0}else z===e?((o=a(s).shift())&&W(o),D=!0):J===e||M===e?((c=a(s).pop())&&W(c),D=!0):G===e&&((c=a(s).pop())&&i.let(c.title),i.focus(),D=!0);else if(Q===e){var x=_(l);if(x&&F(x.requestSubmit)){var y=(g="button:not([type]),button[type=submit],input[type=image],input[type=submit]",(x||f).querySelector(g));y?x.requestSubmit(y):x.requestSubmit()}D=!0}else k?z===e?((o=a(s).shift())&&W(o),D=!0):J===e||M===e?((c=a(s).pop())&&W(c),D=!0):G===e&&((c=a(s).pop())&&i.let(c.title),i.focus(),D=!0):m&&M===e&&((c=a(s).pop())&&W(c),D=!0);D&&P(u)}function pu(){tu=eu=!1}function vu(u){var D=this["_"+U],F=D._tags,t=D.state,e=t.n+"__tag--selected",n=!0,r=(u.clipboardData||c.clipboardData).getData("text")+"";for(var E in F)if(!k(F[E],e)){n=!1;break}n&&D.value.split(t.join).forEach((function(u){return D.let(u)})),r.split(t.join).forEach((function(u){return D.set(u)})),D.fire("paste.tag",[u]).focus(),P(u)}function hu(u){var D=this,F=D["_"+U],t=F._mask,e=F.self,n=F.state,r=t.hint,E=(u.clipboardData||c.clipboardData).getData("text")+"";(function(u,D){var F,t=c.getSelection();t.rangeCount&&((F=t.getRangeAt(0)).deleteContents(),F.insertNode(f.createTextNode(D)))})(0,E),O(r,d(D)?"":e.placeholder),F.fire("paste",[u]),q((function(){E=d(D),F.text="",null!==E&&E.split(n.join).forEach((function(u){return F.set(u)}))}),1)(),P(u)}function _u(u){var D=this,F=D["_"+U],t=F._active,e=F._tags,n=F.state.n+"__tag--selected";if(t){if(W(D),N(D,n),tu);else{Z();var r=2===u.button,E=0;for(var i in e)k(e[i],n)&&++E,D===e[i]||r||y(e[i],n);E>0&&L(D,n)}k(D,n)?(W(D),uu(B(D))):uu(a(e).pop()),F.fire("touch.tag",[u]),P(u),function(u){u&&u.stopPropagation()}(u)}}function gu(u){var D=h(this),F=D["_"+U];F._mask.input,K("click",this,gu),F.let(D.title),F.focus(),P(u)}function du(){this["_"+U].let()}return Fu.attach=function(D,t){var i=this;D=D||i.self,t=t||i.state,i._active=!Y(D)&&!function(u){return u.readOnly}(D),i._tags={},i._value=function(u){return(u.value||l(u,"value",!1)||"").replace(/\r/g,"")}(D),i.self=D,i.state=t;var C=t.n,a=_(D),A=R("div",{class:C,tabindex:!Y(D)&&-1});i.mask=A;var s,o,f=R("span",{class:C+"__tags"}),c=R("span",{class:C+"__text"}),B=R("span",{contenteditable:!Y(D)&&"",spellcheck:"false"}),p=R("span",D.placeholder+"");S(A,f),S(f,c),S(c,B),S(c,p),L(D,C+"__self"),o=A,h(s=D).insertBefore(o,v(s,!0)),a&&(a["_"+U]=i,I("reset",a,du)),I("blur",B,ru),I("click",A,Eu),I("focus",D,su),I("focus",B,Au),I("input",B,lu),I("keydown",B,Bu),I("keyup",B,pu),I("paste",B,hu),D.tabIndex=-1,A["_"+U]=i,B["_"+U]=i;var g={};if(g.hint=p,g.input=B,g.of=D,g.self=A,g.tags=f,g.text=c,i._mask=g,i._value.split(r(t)?t:t.join).forEach((function(u){return i.set(u,1)})),n(t)&&u(t.with))for(var d=0,m=E(t.with);d<m;++d){var k=t.with[d];r(k)&&(k=Du[k]),F(k)?k.call(i,D,t):e(k)&&F(k.attach)&&k.attach.call(i,D,t)}return l(D,"autofocus")?i.focus():i},Fu.blur=function(){Z();var u=this,D=u._mask,F=u._tags,t=D.input;for(var e in F)F[e].blur();return t.blur(),u.fire("blur")},Fu.detach=function(){var D=this,t=D._mask,n=D.mask,i=D.self,C=D.state,a=t.input,A=_(i);if(D._active=!1,A&&K("reset",A,du),K("blur",a,ru),K("click",n,Eu),K("focus",a,Au),K("focus",i,su),K("input",a,lu),K("keydown",a,Bu),K("keyup",a,pu),K("paste",a,hu),u(C.with))for(var s=0,o=E(C.with);s<o;++s){var f=C.with[s];r(f)&&(f=Du[f]),e(f)&&F(f.detach)&&f.detach.call(D,i,C)}return i.tabIndex=null,y(i,C.n+"__self"),j(n),D._mask={of:i},D.mask=null,D},Fu.focus=function(){var u=this._mask.input;return u&&(W(u),uu(u)),this.fire("focus")},Fu.get=function(u){var D=this,F=D._active,t=D._tags;return!!F&&(D.fire("get.tag",[u]),t[u]?u:null)},Fu.let=function(u){var F=this,t=F._active,e=F._tags,n=F._value,r=F.self,E=F.state;if(!t)return F;if(!D(u))return F.value.split(E.join).forEach((function(u){return F.let(u)})),n.split(E.join).forEach((function(u){return F.set(u)})),F;if(i(e)<E.min)return F.fire("min.tags",[u]);if(F.fire("let.tag",[u]),!e[u])return F;var a=e[u];p(a,0);var A=p(a,1);return K("blur",a,nu),K("contextmenu",a,iu),K("copy",a,Cu),K("cut",a,au),K("focus",a,ou),K("keydown",a,fu),K("keyup",a,cu),K("mousedown",a,_u),K("mousedown",A,gu),K("paste",a,vu),K("touchstart",a,_u),K("touchstart",A,gu),j(a),delete F._tags[u],r.value=C(F._tags).join(E.join),F},Fu.set=function(u,D){var t=this,e=t._active,n=t._filter,E=t._mask,a=t._tags,A=t.self,s=t.state,o=E.text,f=s.pattern,c=s.n;if(!e&&!D)return t;if(i(a)>s.max)return t.fire("max.tags",[u]);if(F(n)&&(u=n.call(t,u)),t.fire("set.tag",[u]),""===u||r(f)&&!H(f).test(u))return t.fire("not.tag",[u]);if(a[u])return t.fire("has.tag",[u]);var l,B,p=R("span",{class:c+="__tag",tabindex:!!e&&-1,title:u}),v=R("span",u.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;")),_=R("span",{class:c+="-x",tabindex:-1});return e&&(I("blur",p,nu),I("contextmenu",p,iu),I("copy",p,Cu),I("cut",p,au),I("focus",p,ou),I("keydown",p,fu),I("keyup",p,cu),I("mousedown",p,_u),I("mousedown",_,gu),I("paste",p,vu),I("touchstart",p,_u),I("touchstart",_,gu),p["_"+U]=t),S(p,v),S(p,_),B=p,h(l=o).insertBefore(B,l),t._tags[u]=p,A.value=C(t._tags).join(s.join),t},Du}));