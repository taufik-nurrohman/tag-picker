/*!
 * ==============================================================
 *  TAG PICKER 3.0.7
 * ==============================================================
 * Author: Taufik Nurrohman <https://github.com/taufik-nurrohman>
 * License: MIT
 * --------------------------------------------------------------
 */
!function(t,n,e){function i(t,n){var e=n[B](t);return 0>e?null:e}function a(t,n){return t[C].remove(n)}function u(t,n){return t[C].add(n)}function r(t){return Object.keys(t).length}function s(t,n){return Object.assign(t,n)}function o(t,n){return n[B](t)>=0}function c(t){return"function"==typeof t}function f(t){return"number"==typeof t}function l(t){return void 0!==t}function g(t){return"string"==typeof t}function d(t){p(t)&&t[H][G](t)}function p(t){return t&&t[H]}function v(t,e,i){var a,u,r=g(t)?n[E](t):t;if((e||""===e)&&(r[D]=e),i)for(a in i)u=i[a],null===u||!1===u?r[F](a):r[Q](a,u);return r}var m="Arrow",h=m+"Left",b=m+"Right",x="Backspace",y="Delete",k="Enter",w="Tab",j="__instance__",M="appendChild",T="children",C="classList",E="createElement",L="ctrlKey",R="disabled",_="firstChild",A="forEach",O="getAttribute",B="indexOf",D="innerHTML",I="insertBefore",K="key",N=K+"Code",S="nextSibling",z="nodeName",H="parentNode",P="previousSibling",q="readOnly",F="removeAttribute",G="removeChild",J="replace",Q="setAttribute",U="shiftKey",V="textContent",W="toLowerCase",X=setTimeout;!function(t){t.version="3.0.7",t[j]={},t.each=function(n,e){var i,a;return X(function(){a=t[j];for(i in a)n.call(a[i],i)},0===e?0:e||1),t},t.I={"Maximum tags allowed is %d":"Maximum tags allowed is %d.","Minimum tags allowed is %d":"Minimum tags allowed is %d.","Remove tag %s":"Remove tag “%s”","Tag %s already exists":"Tag “%s” already exists."},t.i=function(n,e){return n=t.I[n]||n,e&&e[A](function(t){n=n[J]("%"+(f(t)?"d":"s"),t)}),n},t._=t.prototype}(t[e]=function(n,p){function m(t,n,e){return l(_n[t])||(_n[t]={}),l(e)||(e=r(_n[t])),_n[t][e]=n,Mn}function C(t,n){return l(t)?l(n)?(delete _n[t][n],Mn):(_n[t]={},Mn):(_n={},Mn)}function E(t,n,e){if(!l(_n[t]))return Mn;if(l(e))l(_n[t][e])&&_n[t][e].apply(Mn,n);else for(var i in _n[t])_n[t][i].apply(Mn,n);return Mn}function B(t){return Mn.f(t)[J](RegExp("("+An.escape.join("|")[J](/\\/g,"\\\\")+")+"),"").trim()}function F(t){if(n[R]||n[q])return ln("");var e,i=B(In[V]);i&&(vn(i)?t&&fn("Tag %s already exists",[i]):(bn(i),hn(i),e=Mn.tags.length,E("change",[i,e]),E("set.tag",[i,e])),ln(""))}function G(){F(1),a(On,"focus"),a(On,"focus.input"),E("blur",[jn,Mn.tags.length])}function Q(){E("click",[Mn.tags])}function Y(){u(On,"focus"),u(On,"focus.input"),E("focus",[Mn.tags])}function Z(t){var e,i=An.escape,u=t[N],r=t[K],s=t[L],c=k===r||13===u,f=t[U],l=w===r||9===u,g=Dn[P],d=Mn.tags.length,p=An.max,v=B(In[V]);c?r="\n":l&&(r="	"),l||(n[R]||n[q]?(c&&n[q]&&yn(),pn(t)):o(r,i)||o(u,i)?(p>d?F(1):(ln(""),fn("Maximum tags allowed is %d",[p])),pn(t)):c?(yn(),pn(t)):X(function(){var n=In[V],c=B(n);o(n.slice(-1),i)?(p>d?F(1):(ln(""),fn("Maximum tags allowed is %d",[p])),pn(t)):""!==c||s||f||(""!==v||x!==r&&8!==u?(h===r||37===u)&&g&&g.focus():(e=Mn.tags[d-1],a(On,"focus.tag"),xn(e),mn(e),g&&(E("change",[e,d-1]),E("let.tag",[e,d-1])))),Kn[D]=c?"":Cn},0))}function $(t){if(On[H])for(var e;e=Dn[P];)xn(e.title);for(Mn.tags=[],n.value="",t=t?t.split(An.join):[],wn=An.max,jn,kn=0;wn>kn&&t[kn];++kn)if(""!==(jn=B(t[kn]))){if(vn(jn))continue;bn(jn),hn(jn),E("change",[jn,kn]),E("set.tag",[jn,kn])}}function tn(t){if(!n[R]){var e=An.min;return F(),e>0&&Mn.tags.length<e?(ln("",1),fn("Minimum tags allowed is %d",[e]),void pn(t)):1}}function nn(){X(function(){n[R]||n[q]||$(In[V]),ln("")},0)}function en(t){t&&On===t.target&&(In.focus(),Q())}function an(){In.focus()}function un(){var t=this,n=t.title;a(On,"focus"),a(On,"focus.tag"),E("blur.tag",[n,i(n,Mn.tags)])}function rn(){var t=this.title;E("click.tag",[t,i(t,Mn.tags)])}function sn(){var t=this,n=t.title;u(On,"focus"),u(On,"focus.tag"),E("focus.tag",[n,i(n,Mn.tags)])}function on(t){if(!n[R]&&!n[q]){var e=this[H].title;xn(e),mn(e),ln("",1)}pn(t)}function cn(t){var e=this,u=t[N],r=t[K],s=(t[L],n[q]),o=(t[U],e[P]),c=e[S];if(s||h!==r&&37!==u)if(s||b!==r&&39!==u){if(x===r||y===r||8===u||46===u){if(!s){var f=e.title,l=i(f,Mn.tags);a(On,"focus.tag"),xn(f),mn(f),x===r||8===u?o?o.focus():ln("",1):c&&c!==Dn?c.focus():ln("",1),E("change",[f,l]),E("let.tag",[f,l])}pn(t)}}else c&&c!==Dn?c.focus():ln("",1),pn(t);else o&&(o.focus(),pn(t))}function fn(t,n){var e,i=An.alert;!0===i&&(e=Tn.i(t,n))?alert(e):c(i)?i.apply(Mn,n):g(i)&&Tn[i]&&Tn[i].apply(Mn,n)}function ln(t,n){In[V]=t,Kn[V]=t?"":Cn,n&&In.focus()}function gn(t,n,e){t.removeEventListener(n,e)}function dn(t,n,e){t.addEventListener(n,e,!1)}function pn(t){t&&t.preventDefault()}function vn(t,n){var e=i(t,Mn.tags);return n&&E("get.tag",[t,e]),f(e)?t:null}function mn(t){var e=i(t,Mn.tags);return f(e)&&e>=0?(Mn.tags.splice(e,1),n.value=Mn.tags.join(An.join),!0):!1}function hn(t,e){f(e)?(e=0>e?0:e,Mn.tags.splice(e,0,t)):Mn.tags.push(t),n.value=Mn.tags.join(An.join)}function bn(t,e){var i=v("span",0,{"class":"tag",tabindex:n[R]?!1:"0",title:t});if(An.x){var a=v("a",0,{href:"",tabindex:"-1",title:Tn.i("Remove tag %s",[t])});dn(a,"click",on),i[M](a)}dn(i,"blur",un),dn(i,"click",rn),dn(i,"focus",sn),dn(i,"keydown",cn),Bn[H]&&(f(e)&&Mn.tags[e]?Bn[I](i,Bn[T][e]):Bn[I](i,Dn))}function xn(t){var n,e=i(t,Mn.tags);if(f(e)&&e>=0&&(n=Bn.children[e])){if(gn(n,"blur",un),gn(n,"click",rn),gn(n,"focus",sn),gn(n,"keydown",cn),An.x){var a=n[_];gn(a,"click",on),d(a)}d(n)}}function yn(){tn()&&Rn&&Rn.submit()}if(n){var kn,wn,jn,Mn=this,Tn=t[e],Cn=n.placeholder||"",En=n[O]("tabindex"),Ln={alert:!0,"class":"tag-picker",escape:[",",188],join:", ",max:9999,min:0,x:!1};if(n[e])return Mn;if(!(Mn instanceof Tn))return new Tn(n,p);Tn[j][n.id||n.name||r(Tn[j])]=Mn,n[e]=1,g(p)&&(p={join:p});var Rn,_n={},An=s(Ln,p),On=v("span",0,{"class":An["class"]}),Bn=v("span",0,{"class":"tags"}),Dn=v("span",0,{"class":"editor tag"}),In=v("span",0,{contenteditable:n[R]?!1:"true",spellcheck:"false",style:"white-space:pre;"}),Kn=v("span");for(Mn.f=function(t){return t[W]()[J](/[^ a-z0-9-]/g,"")},ln(""),u(n,An["class"]+"-source"),n[H][I](On,n[S]),On[M](Bn),Bn[M](Dn),Dn[M](In),Dn[M](Kn),v(n,0,{tabindex:"-1"}),Rn=n[H];Rn&&Rn[z]&&"form"!==Rn[z][W]();)Rn=Rn[H];dn(In,"blur",G),dn(In,"click",Q),dn(In,"focus",Y),dn(In,"keydown",Z),dn(In,"paste",nn),dn(n,"focus",an),dn(On,"click",en),Rn&&dn(Rn,"submit",tn),Mn.tags=[],$(n.value),Mn.input=In,Mn.self=Mn.view=On,Mn.source=Mn.output=n,Mn.state=An,Mn.blur=function(){return!n[R]&&(In.blur(),G()),Mn},Mn.click=function(){return On.click(),en(),Mn},Mn.fire=function(t,n,e){return E(t,n,e)},Mn.focus=function(){return n[R]||(In.focus(),Y()),Mn},Mn.get=function(t){return n[R]?null:vn(t,1)},Mn.let=function(t,e){if(!n[R]&&!n[q]){var i=An.min;if(F(),e&&i>0&&Mn.tags.length<i)return fn("Minimum tags allowed is %d",[i]),Mn;xn(t),mn(t)}return Mn},Mn.on=function(t,n,e){return m(t,n,e)},Mn.off=function(t,n){return C(t,n)},Mn.pop=function(){return n[e]?(delete n[e],gn(In,"blur",G),gn(In,"click",Q),gn(In,"focus",Y),gn(In,"keydown",Z),gn(In,"paste",nn),gn(n,"focus",an),gn(On,"click",en),Rn&&gn(Rn,"submit",tn),Mn.tags[A](xn),a(n,An["class"]+"-source"),v(n,0,{tabindex:En}),d(On),E("pop")):Mn},Mn.set=function(t,e,i){if(!n[R]&&!n[q])if(vn(t))i&&fn("Tag %s already exists",[t]);else{var a=An.max;Mn.tags.length<a?(bn(t,e),hn(t,e)):i&&fn("Maximum tags allowed is %d",[a])}return Mn},Mn.value=function(t){return!n[R]&&!n[q]&&$(t),Mn}}})}(window,document,"TP");