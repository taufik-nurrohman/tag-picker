/*!
 *
 * The MIT License (MIT)
 *
 * Copyright © 2025 Taufik Nurrohman <https://github.com/taufik-nurrohman>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the “Software”), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED “AS IS”, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */
!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(t="undefined"!=typeof globalThis?globalThis:t||self).TagPicker=n()}(this,function(){"use strict";function t(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=Array(n);e<n;e++)r[e]=t[e];return r}function n(n,e,r){if(e&&!Array.isArray(e)&&"number"==typeof e.length){var i=e.length;return t(e,void 0!==r&&r<i?r:i)}return n(e,r)}function e(n,e){return function(t){if(Array.isArray(t))return t}(n)||function(t,n){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var r,i,u,a,o=[],f=!0,c=!1;try{if(u=(e=e.call(t)).next,0===n){if(Object(e)!==e)return;f=!1}else for(;!(f=(r=u.call(e)).done)&&(o.push(r.value),o.length!==n);f=!0);}catch(t){c=!0,i=t}finally{try{if(!f&&null!=e.return&&(a=e.return(),Object(a)!==a))return}finally{if(c)throw i}}return o}}(n,e)||function(n,e){if(n){if("string"==typeof n)return t(n,e);var r={}.toString.call(n).slice(8,-1);return"Object"===r&&n.constructor&&(r=n.constructor.name),"Map"===r||"Set"===r?Array.from(n):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?t(n,e):void 0}}(n,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var r=function(t){return Array.isArray(t)},i=function(t){return"function"==typeof t},u=function(t,n,e){return!(!t||"object"!=typeof t)&&(e?c(n)&&c(t.constructor)&&n===t.constructor:c(n)&&t instanceof n)},a=function(t){return o(t)&&0==t%1},o=function(t){return"number"==typeof t&&!Number.isNaN(t)},f=function(t,n){return void 0===n&&(n=!0),!(!t||"object"!=typeof t)&&(!n||u(t,Object,1))},c=function(t){return function(t){return void 0!==t}(t)&&!function(t){return null===t}(t)},l=function(t){return"string"==typeof t},s=function(t,n){return-1!==n.indexOf(t)},v=function(){for(var t=arguments.length,n=Array(t),e=0;e<t;e++)n[e]=arguments[e];for(var i=n.shift(),u=0,a=g(n);u<a;++u)for(var o in n[u])if(c(i[o]))if(r(i[o])&&r(n[u][o])){i[o]=[].concat(i[o]);for(var l=0,h=g(n[u][o]);l<h;++l)s(n[u][o][l],i[o])||i[o].push(n[u][o][l])}else f(i[o])&&f(n[u][o])?i[o]=v({},i[o],n[u][o]):i[o]=n[u][o];else i[o]=n[u][o];return i},h=function(t){if(r(t))return t.map(function(n){return h(t)});if(f(t)){for(var n in t)t[n]=h(t[n]);return t}return!1===t?"false":null===t?"null":!0===t?"true":""+t},d=function(t){return t.replace(/[-_.](\w)/g,function(t,n){return m(n)})},p=function(t){return t.toLowerCase()},m=function(t){return t.toUpperCase()},g=function(t){return t.length},_=function(t){if(r(t))return t.map(function(t){return _(t)});if(f(t)){for(var n in t)t[n]=_(t[n]);return t}return l(t)&&function(t){return/^[+-]?(?:\d*\.)?\d+$/.test(t+"")}(t)?"0"===t[0]&&-1===t.indexOf(".")?t:function(t,n){return void 0===n&&(n=10),n?parseInt(t,n):parseFloat(t)}(t):"false"!==t&&("null"===t?null:"true"===t||t)};function y(t){return t[Symbol.iterator]()}var b=function(t,n){for(var e,r=0,i=g(t);r<i;++r)if(-1!==(e=n.call(t,t[r],r))){if(0===e)break}else t.splice(r,1);return t},x=function(t,r){for(var i=y(t),u=i.next();!u.done;){var a=n(e,u.value,2),o=a[0],f=a[1];if(-1===(f=r.call(t,f,o)))E(o,t);else if(0===f)break;u=i.next()}return t},k=function(t,n){var e;for(var r in t)if(-1!==(e=n.call(t,t[r],r))){if(0===e)break}else delete t[r];return t},w=function(t,n){for(var e=y(t),r=e.next();!r.done;){var i,u=r.value;if(-1===(u=n.call(t,u,i=u)))E(i,t);else if(0===u)break;r=e.next()}return t},S=function(t){return t.prototype},j=function(t){return A(t,q)||null},A=function(t,n){return n.get(t)},T=function(t,n){return n.has(t)},E=function(t,n){return n.delete(t)},C=function(t,n,e){return e||(t=S(t)),k(n,function(n,e){Object.defineProperty(t,e,n)}),t},R=function(t,n,e){return t=S(t),k(n,function(n,e){t[e]=n}),t},N=function(t,n){return D(t,n,q)},D=function(t,n,e){return e.set(t,n)},O=function(t){return L(t).shift()},M=function(t){return L(t).pop()},L=function(t){var n=[];return x(t,function(t){n.push(t)}),n},q=new WeakMap;var K=document,I=window,z=function(t,n,e){return void 0===e&&(e=!0),H(t,"aria-"+n,e)},H=function(t,n,e){if(void 0===e&&(e=!0),!nt(t,n))return null;var r=t.getAttribute(n);return e?_(r):r},B=function(t,n){return t["first"+(n?"":"Element")+"Child"]||null},P=function(t,n,e){var r,i=(r=t.childNodes,Array.from(r));return o(n)?i[n]||null:i},W=function(t,n){return(n||K).querySelector(t)},F=function(t,n){if(!t||!J(t))return-1;for(var e=0;t=Q(t,n);)++e;return e},U=function(t,n){return void 0===n&&(n="e:"),et(t)?H(t,"id"):(c(jt[n])||(jt[n]=0),n+(e=Date.now()+(jt[n]+=1),r=16,o(e)?e.toString(r):""+e));var e,r},$=function(t,n){return t["next"+(n?"":"Element")+"Sibling"]||null},J=function(t,n){return n?t.closest(n)||null:t.parentNode||null},G=function(t){var n="form";return rt(t,n)&&n===function(t){return p(t&&t.nodeName||"")||null}(t[n])?t[n]:J(t,n)},Q=function(t,n){return t["previous"+(n?"":"Element")+"Sibling"]||null},V=function(t){return H(t,"role")},X=function(t,n){return rt(t,n)&&t[n]||null},Y=function(t,n){void 0===n&&(n=!0);var e="textContent";if(!rt(t,e))return!1;var r=t[e];return""!==(r=n?r.trim():r)?r:null},Z=function(t){return t&&t.nodeType||null},tt=function(t,n){var e=(t.value||"").replace(/\r?\n|\r/g,"\n");return""!==(e=n?_(e):e)?e:null},nt=function(t,n){return t.hasAttribute(n)},et=function(t){return nt(t,"id")},rt=function(t,n){return n in t},it=function(t,n){return ut(t,"aria-"+n)},ut=function(t,n){return t.removeAttribute(n),t},at=function(t,n){return t.classList.remove(n),t},ot=function(t){var n=J(t);return t.remove(),n},ft=function(t,n){return t.style[d(n)]=null,t},ct=function(t,n,e){return lt(t,"aria-"+n,!0===e?"true":e)},lt=function(t,n,e){return!0===e&&(e=n),t.setAttribute(n,h(e)),t},st=function(t,n){return k(n,function(n,e){return"aria"===e&&f(n)?(function(t,n){k(n,function(n,e){n||""===n||0===n?ct(t,e,n):it(t,e)})}(t,n),1):"class"===e?(dt(t,n),1):"data"===e&&f(n)?(pt(t,n),1):"style"===e&&f(n)?(wt(t,n),1):void(n||""===n||0===n?lt(t,e,n):ut(t,e))}),t},vt=function(t,n){return t.append(n),n},ht=function(t,n){return t.classList.add(n),t},dt=function(t,n){return r(n)?(b(n,function(n){return ht(t,n)}),t):f(n)?(k(n,function(n,e){return n?ht(t,e):at(t,e)}),t):(t.className=n,t)},pt=function(t,n){return k(n,function(n,e){n||""===n||0===n?mt(t,e,n):function(t,n){ut(t,"data-"+n)}(t,e)}),t},mt=function(t,n,e){return(r(e)||f(e))&&(e=JSON.stringify(e)),lt(t,"data-"+n,!0===e?"true":e)},gt=function(t,n,e,i){return t=l(t)?K.createElement(t,l(i)?{is:i}:i):t,r(n)&&g(n)?(!function(t){var n="innerHTML";rt(t,n)&&(t[n]="")}(t),b(n,function(t){return vt(l(t)?_t(t):t)})):f(n)&&(e=n,n=!1),l(n)&&yt(t,n),f(e)?(st(t,e),t):t},_t=function(t){return l(t)&&(t=K.createTextNode(t)),t},yt=function(t,n,e){if(void 0===e&&(e=!0),null===n)return t;var r="innerHTML";return rt(t,r)&&(t[r]=e?n.trim():n),t},bt=function(t,n,e){return void 0===e&&(e="e:"),lt(t,"id",c(n)?n:U(t,e))},xt=function(t,n){return t.after(n),n},kt=function(t,n,e){return o(e)&&(e+="px"),t.style[d(n)]=h(e),t},wt=function(t,n){return k(n,function(n,e){n||""===n||0===n?kt(t,e,n):ft(t,e)}),t},St=function(t,n){return null===n?ut(t,"value"):(t.value=h(n),t)},jt={},At=Date.now,Tt=new WeakMap,Et=new WeakMap,Ct=function(){return K.getSelection()},Rt=function(){return K.createRange()},Nt=function(t,n){return(n||Ct()).rangeCount>0},Dt=function(t,n){return(n=n||Ct()).empty(),n},Ot=function(t,n){return E(t,Tt),E(t,Et),Lt(t,n)},Mt=function(t,n,e){var r=0,i=Rt();i.setStart(t,0),i.collapse(!0);for(var u,a,o,f=[t];!u&&(o=f.pop());)if(3===Z(o)){var c=r+g(o);!a&&n[0]>=r&&n[0]<=c&&(i.setStart(o,n[0]-r),a=!0),a&&n[1]>=r&&n[1]<=c&&(u=!0,i.setEnd(o,n[1]-r)),r=c}else b(P(o,null),function(t){return f.push(t)});return It(t,i,Dt(0,e))},Lt=function(t,n){var e,r,i,u,a=null!=(e=A(t,Tt))?e:[],o=null!=(r=A(t,Et))?r:g(a)-1,f=null!=(i=function(t,n){void 0===n&&(n=!0);var e="innerHTML";if(!rt(t,e))return!1;var r=t[e];return""!==(r=n?r.trim():r)?r:null}(t))?i:"";return u=Nt(t,n)?function(t){var n=Ct().getRangeAt(0),e=n.cloneRange();e.selectNodeContents(t),e.setEnd(n.startContainer,n.startOffset);var r=g(e+"");return[r,r+g(n+"")]}(t):[],a[o]&&f===a[o][0]&&u[0]===a[o][1][0]&&u[1]===a[o][1][1]||(o<g(a)-1&&a.splice(o+1),a.push([f,u,At()]),D(t,a,Tt),D(t,++o,Et)),t},qt=function(t,n,e){e=e||Ct(),Dt(0,e);var r=Rt();r.selectNodeContents(t),e=It(t,r,e),1===n?e.collapseToEnd():-1===n&&e.collapseToStart()},Kt=function(t,n){return(n=n||Ct()).rangeCount&&n.removeRange(n.getRangeAt(0)),n},It=function(t,n,e){return e=e||Ct(),r(n)?Mt(t,n,e):(e.addRange(n),e)};var zt=I.clearTimeout,Ht=I.setTimeout,Bt=function(t,n){var e,r=a(n)&&n>=0;return[function(){var i=this,u=Array.from(arguments);r||(n=u.shift()),e=Ht(function(){return t.apply(i,u)},n)},function(){e&&zt(e)}]};var Pt,Wt,Ft,Ut=function(t,n,e){n.removeEventListener(t,e)},$t=function(t){return t&&t.preventDefault()},Jt=function(t,n,e,r){void 0===r&&(r=!1),n.addEventListener(t,e,r)},Gt=function(t,n){return function(t){return u(t,RegExp)}(t)?t:RegExp(t,c(n)?n:"g")},Qt="down",Vt="blur",Xt="copy",Yt="cut",Zt="focus",tn="input",nn="before"+tn,en="invalid",rn="key"+Qt,un="keyup",an="mouse"+Qt,on="paste",fn="reset",cn="submit",ln="touchstart",sn="Arrow",vn=sn+"Left",hn=sn+"Right",dn="Home",pn="Backspace",mn="Enter",gn="Tab",_n="contenteditable",yn="disabled",bn="false",xn=en,kn="pressed",wn="readonly",Sn="required",jn="tabindex",An="tabIndex",Tn="true",En="value",Cn=En+"s",Rn="visibility",Nn=n(e,Bt(function(t){it(t.mask,xn)}),2),Dn=Nn[0],On=Nn[1],Mn=function(t){var n=t.mask,e=t.state.time.error;a(e)&&e>0&&ct(n,xn,!0)},Ln=n(e,Bt(function(t){Lt(t)},1),1)[0],qn=n(e,Bt(function(t){var n=t._mask.input;Kn(t,Y(n,0))}),1)[0],Kn=function(t,n){var e=t._mask.hint;n?kt(e,Rn,"hidden"):ft(e,Rn)},In="TagPicker";function zn(t,n){var e=u(n,Map)?n:new Map;r(n)?b(n,function(t){var n,i,u;r(t)?(t[0]=null!=(n=t[0])?n:"",t[1]=null!=(i=t[1])?i:{},D(_(null!=(u=t[1][En])?u:t[0]),t,e)):D(_(t),[t,{}],e)}):f(n,0)&&k(n,function(t,i){var u,a,o;r(t)?(n[i][0]=null!=(u=t[0])?u:"",n[i][1]=null!=(a=t[1])?a:{},D(_(null!=(o=t[1][En])?o:i),t,e)):D(_(i),[t,{}],e)});var i=t._tags,a=[];return i.let(null,0),x(e,function(t,n){var e,u;r(t)&&t[1]&&a.push(null!=(u=t[1][En])?u:n);i.set(_(r(t)&&t[1]&&null!=(e=t[1][En])?e:n),t,0)}),a}function Hn(t){return t.focus(),t}function Bn(t,n){return tt(t,n)}function Pn(t){$t(t)}function Wn(t){var n=this,e=t.data,r=t.inputType,i=j(n),u=i._active,a=i._fix;if(!u||a)return $t(t);var o,f,c,v,h=i._tags,d=i.state.escape;f=l(e)&&1===g(e)?e:0,mn===f&&(s("\n",d)||s(13,d))||gn===f&&(s("\t",d)||s(9,d))||0!==f&&s(f,d)?(o=!0,D(_(v=Y(n)),v,h),Hn(i).text=""):"deleteContentBackward"!==r||Y(n,0)||(c=M(h))&&(o=!0,E(Bn(c[2]),h)),o&&$t(t)}function Fn(){var t=j(this)._tags;Pt||Wt||x(t,function(t){return it(t[2],kn)})}function Un(){var t=j(this),n=t.mask,e=t.state.time.error;Dn(a(e)&&e>0?e:0,t),Jt(an,n,ae),Jt(ln,n,ae)}function $n(t){$t(t);var n=this,e=j(n),r=e._tags,i=e.state.join,u=[];ct(n,kn,!0),x(r,function(t){z(t[2],kn)&&u.push(Bn(t[2]))}),t.clipboardData.setData("text/plain",u.join(i)),Yt!==t.type&&g(u)<2&&it(n,kn)}function Jn(t){$t(t);var n=j(this),e=n._tags;$n.call(this,t),x(e,function(t){z(t[2],kn)&&E(Bn(t[2]),e)}),Hn(n.fire("change",[n[En]]))}function Gn(){var t=this;Lt(t),qn(1,j(t)),Ln(t)}function Qn(){Hn(j(this))}function Vn(){qt(this)}function Xn(){var t=this,n=j(t),e=n.mask,r=n.state.pattern,i=Y(t);i&&l(r)&&!Gt(r).test(i)&&(On(),Mn(n)),qt(t),Ut(an,e,ae),Ut(ln,e,ae)}function Yn(t){var n=this,e=j(n),r=e._active,i=e._fix;if(!r||i)return $t(t);var u=e.state.pattern,a=t.inputType,o=Y(n,0);"deleteContent"!==a.slice(0,13)||o?"insertText"===a&&(Kn(e,1),Ln(n)):(Kn(e,0),Ln(n)),l(u)&&!Gt(u).test(o)?(On(),Mn(e)):Dn(0,e)}function Zn(t){t&&$t(t);Un.call(this),Mn(j(this))}function te(t){var n=Ft=this,e=t.key,r=Pt=t.ctrlKey,i=Wt=t.shiftKey,u=j(n),a=u._active,o=u._fix;if(!a||o)return $t(t);var f,c,l,s,v,h=u._mask,d=u._tags,p=h.text;i?(f=!0,ct(n,kn,!0),vn===e?(v=Q(n))&&(z(v,kn)?it(n,kn):ct(v,kn,!0),Hn(v)):hn===e?(s=$(n))&&s!==p&&(z(s,kn)?it(n,kn):ct(s,kn,!0),Hn(s)):gn===e&&Kt()):r?"a"===e?(f=!0,x(d,function(t){return ct(t[2],kn,!0),Hn(t[2]),qt(t[2])})):vn===e?(f=!0,(v=Q(n))&&Hn(v)):hn===e?(f=!0,(s=$(n))&&s!==p&&Hn(s)):dn===e?(f=!0,(c=O(d))&&Hn(c[2])):"End"===e?(f=!0,(l=M(d))&&Hn(l[2])):mn===e||" "===e?(f=!0,z(n,kn)?it(n,kn):ct(n,kn,!0)):ct(n,kn,!0):vn===e?(f=!0,(v=Q(n))&&Hn(v)):hn===e?(f=!0,Hn((s=$(n))&&s!==p?s:u)):dn===e?(f=!0,(c=O(d))&&Hn(c[2])):"End"===e?(f=!0,(l=M(d))&&Hn(l[2])):pn===e?(f=!0,v=Q(n),E(Bn(n),d),x(d,function(t){z(t[2],kn)&&(v=Q(t[2]),E(Bn(t[2]),d))}),Hn(v||u),u.fire("change",[u[En]])):"Delete"===e?(f=!0,s=$(n),E(Bn(n),d),x(d,function(t){z(t[2],kn)&&(s=$(t[2]),E(Bn(t[2]),d))}),Hn(s&&s!==p?s:u),u.fire("change",[u[En]])):mn===e||" "===e?(f=!0,z(n,kn)?it(n,kn):ct(n,kn,!0)):"Escape"===e||gn===e?(f=!0,Kt(),Hn(u)):1===g(e)&&(x(d,function(t){z(t[2],kn)&&E(Bn(t[2]),d)}),Kt(),Hn(u).fire("change",[u[En]])),f&&$t(t)}function ne(t){var n=this,e=t.key,r=t.keyCode,u=Pt=t.ctrlKey,a=Wt=t.shiftKey,o=j(n),f=o._active,c=o._fix;if(f&&!c){var l,v,h,d,m=o._tags,y=o.self,b=o.state.escape;if(mn===e&&(s("\n",b)||s(13,b))||gn===e&&(s("\t",b)||s(9,b))||s(e,b)||s(r,b))return D(_(d=Y(n)),d,m),Hn(o).text="",$t(t);qn(1,o);var k,w,S,T,C,R,N,L,q,K=""===function(t,n,e){if(e=e||Ct(),!Nt(t,e))return null;var r=e.getRangeAt(0).cloneRange();return r.collapse(!0),r.setStart(t,0),(r+"").slice(-1)}(n),I=!Y(n,0);a?vn===e?(K||I)&&(l=!0,Kt(),(w=M(m))&&Hn(w[2])&&ct(w[2],kn,!0)):mn===e?l=!0:gn===e&&Kt():u?"a"===p(e)&&I&&m.count()?(l=!0,x(m,function(t){return ct(t[2],kn,!0),Hn(t[2]),qt(t[2])})):vn===e?(l=!0,(w=M(m))&&Hn(w[2])):dn===e?(l=!0,(k=O(m))&&Hn(k[2])):mn===e?l=!0:a||"z"!==p(e)?(a&&"z"===p(e)||"y"===p(e))&&(l=!0,function(t,n){var e,r,i,u=null!=(e=A(t,Tt))?e:[],a=null!=(r=A(t,Et))?r:g(u)-1;(i=u[a+1])?(a++,D(t,a,Et),yt(t,i[0]),Mt(t,i[1],n)):Mt(t,u[a][1],n)}(n)):(l=!0,L=null!=(C=A(S=n,Tt))?C:[],q=null!=(R=A(S,Et))?R:g(L)-1,(N=L[q-1])?(q--,D(S,q,Et),yt(S,N[0]),Mt(S,N[1],T)):Mt(S,L[q][1],T)):dn===e?(l=!0,(k=O(m))&&Hn(k[2])):mn===e?(l=!0,(v=G(y))&&i(v.requestSubmit)&&((h=W("button:not([type]),button[type=submit],input[type=image],input[type=submit]",v))?v.requestSubmit(h):v.requestSubmit())):gn===e?Kt():(K||I)&&(vn===e?(l=!0,Kt(),(w=M(m))&&Hn(w[2])):pn===e&&I&&(l=!0,(w=M(m))&&E(Bn(w[2]),m))),l&&$t(t)}}function ee(t){Ft=0;var n=t.key,e=j(this)._tags,r=0;x(e,function(t){z(t[2],kn)&&++r}),Pt=t.ctrlKey,Wt=t.shiftKey,r<2&&!Pt&&!Wt&&mn!==n&&" "!==n&&it(this,kn)}function re(t){Pt=t.ctrlKey,Wt=t.shiftKey}function ie(t){$t(t);var n=j(this),e=n._tags,r=n.state.join;b(t.clipboardData.getData("text/plain").split(r),function(t){T(t=_(t.trim()),e)||D(t,t,e)}),x(e,function(t){return it(t[2],kn)}),Hn(n.fire("change",[n[En]]))}function ue(t){$t(t);var n,e=this,i=j(e),u=i._tags,a=i.self,o=i.state.join;Lt(e),qn(1,i),function(t,n,e,i){var u,a,o,f,c,s;if(i=i||Ct(),!Nt(t,i))return!1;if((a=i.getRangeAt(0)).deleteContents(),o=K.createDocumentFragment(),l(n))for(u=gt("div"),yt(u,n);f=B(u,1);)s=vt(o,f);else r(n)?b(n,function(t){return s=vt(o,t)}):s=vt(o,n);c=B(o,1),a.insertNode(o),s&&((a=a.cloneRange()).setStartAfter(s),a.setStartBefore(c),a.collapse(),It(t,a,Kt(t,i)))}(e,n=t.clipboardData.getData("text/plain")),Ln(e),n!==Y(e)||(b((Y(e)+"").split(o),function(t){T(t=_(t.trim()),u)?(Zn.call(a),i.fire("has.tag",[_(t)])):D(t,t,u)}),x(u,function(t){return it(t[2],kn)}),i.fire("change",[i[En]]).text="")}function ae(t){$t(t);var n=j(this),e=t.target;if(!e||"option"!==V(e)){for(;e&&this!==e;)if((e=J(e))&&"option"===V(e))return;Hn(n)}}function oe(t){$t(t);var n=this,e=j(n)._tags;if(Hn(n),qt(n),Pt||x(e,function(t){return it(t[2],kn)}),Pt)ct(n,kn,!0);else if(Wt&&Ft){var r,i,u=F(n),a=F(Ft),o=Ft;if(ct(n,kn,!0),ct(Ft,kn,!0),u>a)for(;(r=$(o))&&n!==r;)ct(o=r,kn,!0);else if(u<a)for(;(i=Q(o))&&n!==i;)ct(o=i,kn,!0)}}function fe(t){$t(t);var n=J(this),e=j(n),r=e._active,i=e._fix;if(!r||i)return Hn(e);var u=e._tags;E(Bn(n),u),Hn(e)}function ce(){w(j(this),function(t){return t.reset()})}function le(t){w(j(this),function(n){var e,r=n._tags,i=n.max,u=n.min,a=n.self,o=r.count();o>i?(e=!0,Hn(n.fire("max.tags",[o,i]))):o<u&&(e=!0,Hn(n.fire("min.tags",[o,u]))),e&&(Zn.call(a),$t(t))})}function se(t,n){var e=this;if(!t)return e;if(!u(e,se))return new se(t,n);N(t,function(t,n){return(n=n||t).fire=function(t,n,e){var r=this,i=r.hooks;return c(i[t])?(b(i[t],function(t){t.apply(e||r,n)}),r):r},n.off=function(t,n){var e=this,r=e.hooks;if(!c(t))return r={},e;if(c(r[t]))if(c(n)){var i=g(r[t]);if(0===i)delete r[t];else for(var u=0;u<i;++u)if(n===r[t][u]){r[t].splice(u,1);break}}else delete r[t];return e},n.on=function(t,n){var e=this.hooks;return c(e[t])||(e[t]=[]),c(n)&&e[t].push(n),this},t.hooks={},t}(e,se._));var r=v({},se.state,l(n)?{join:n}:n||{});return f(n)&&n.escape&&(r.escape=n.escape),e.attach(t,r)}function ve(t,n){var e=this;return u(e,ve)?(e.of=t,e[Cn]=new Map,n&&zn(t,n),e):new ve(t,n)}return se.from=function(t,n){return new se(t,n)},se.of=j,se.state={escape:[","],join:", ",max:1/0,min:0,n:"tag-picker",pattern:null,time:{error:1e3},with:[]},se.version="4.2.7",C(se,{name:{value:In}},1),C(se,{active:{get:function(){return this._active},set:function(t){Kt();var n=this,e=n._mask,r=n._tags,i=n.mask,u=n.self,a=e.input,o=!!t;return u[yn]=!(n._active=o),o?(it(a,yn),it(i,yn),lt(a,_n,""),x(r,function(t){lt(t[2],_n,""),lt(t[2],jn,-1)})):(ut(a,_n),ct(a,yn,!0),ct(i,yn,!0),x(r,function(t){ut(t[2],_n),ut(t[2],jn)})),n}},fix:{get:function(){return this._fix},set:function(t){Kt();var n=this,e=n._mask,r=n._tags,i=n.mask,u=n.self,a=e.input,o=!!t;return u.readOnly=n._fix=o,o?(ut(a,_n),ct(a,wn,!0),ct(i,wn,!0),lt(a,jn,0),x(r,function(t){ut(t[2],_n),ut(t[2],jn)})):(it(a,wn),it(i,wn),ut(a,jn),lt(a,_n,""),x(r,function(t){lt(t[2],_n,""),lt(t[2],jn,-1)})),n}},max:{get:function(){var t=this.state.max;return 1/0===t||a(t)&&t>=0?t:1/0},set:function(t){return this.state.max=a(t)&&t>=0?t:1/0,this}},min:{get:function(){var t=this.state.min;return a(t)&&t>=0?t:0},set:function(t){return this.state.min=a(t)&&t>=0?t:0,this}},tags:{get:function(){return this._tags},set:function(t){Kt();var n=this,e=[];return zn(n,t),x(n._tags,function(t){return e.push(Bn(t[2],1))}),n.fire("set.tags",[e])}},text:{get:function(){return Y(this._mask.input)},set:function(t){var n=this,e=n._active,r=n._fix;if(!e||r)return n;var i,u=n._mask.input;return function(t,n,e){if(void 0===e&&(e=!0),null===n)return t;var r="textContent";rt(t,r)&&(t[r]=e?n.trim():n)}(u,i=h(t)),Kn(n,i),Ot(u),n}},value:{get:function(){var t=tt(this.self);return""!==t?t:null},set:function(t){var n=this;if(!n._active)return n;var e=n._tags,r=n.state.join;return n[En]&&b(n[En].split(r),function(t){return E(t,e)}),t&&b(t.split(r),function(t){return D(t,t,e)}),n.fire("change",[n[En]])}},vital:{get:function(){return this._vital},set:function(t){Kt();var n=this,e=n._mask,r=n.mask,i=n.min,u=n.self,a=e.input,o=!!t;return u[Sn]=n._vital=o,o?(0===i&&(n.min=1),ct(a,Sn,!0),ct(r,Sn,!0)):(n.min=0,it(a,Sn),it(r,Sn)),n}}}),se._=R(se,{attach:function(t,n){var e=this;t=t||e.self,n&&l(n)&&(n={join:n}),n=v({},e.state,n||{}),e._tags=new ve(e),e.self=t,e.state=n;var u=n,o=u.max,s=u.min,h=u.n,d=t.disabled,p=function(t){return t.readOnly}(t),m=function(t){return t.required}(t),g=t.id,_=t.name,y=t.placeholder,x=tt(t);e._active=!d,e._fix=p,e._vital=m,m&&s<1&&(n.min=s=1);var k=G(t),w=gt("div",{aria:{disabled:!!d&&Tn,multiselectable:Tn,readonly:!!p&&Tn,required:!!m&&Tn},class:h,role:"listbox"});e.mask=w;var S=gt("span",{class:h+"__flex",role:"none"}),A=gt("span",{class:h+"__text",role:"none"}),T=gt("span",{aria:{disabled:!!d&&Tn,multiline:bn,placeholder:y,readonly:!!p&&Tn,required:!!m&&Tn},autocapitalize:"off",contenteditable:!d&&!p&&"",role:"textbox",spellcheck:bn,tabindex:!!p&&0}),E=gt("span",y+"",{aria:{hidden:Tn}});if(vt(w,S),vt(S,A),vt(A,T),vt(A,E),ct(t,"hidden",!0),ht(t,h+"__self"),N(T,e),xt(t,w),vt(w,t),k){var C=j(k)||new Set;C.add(e),Jt(fn,k,ce),Jt(cn,k,le),bt(k),N(k,C)}Jt(Vt,T,Un),Jt(Yt,T,Gn),Jt(Zt,t,Qn),Jt(Zt,T,Xn),Jt(tn,T,Yn),Jt(nn,T,Wn),Jt(en,t,Zn),Jt(rn,T,ne),Jt(un,T,re),Jt(an,w,ae),Jt(on,T,ue),Jt(ln,w,ae),t[An]=-1,N(w,e),e._mask={flex:S,hint:E,input:T,of:t,self:w,text:A},e.max=o=1/0===o||a(o)&&o>=0?o:1/0,e.min=s=a(s)&&s>=0?s:0;var R,D=e._active,O=n.join;return e._active=!0,R=zn(e,x?x.split(O):[]),e["_"+En]=R.join(O),e._active=D,ct(T,"controls",U(bt(S))),bt(w),bt(t),bt(T),bt(E),g&&mt(w,"id",g),_&&mt(w,"name",_),c(n)&&r(n.with)&&b(n.with,function(r,u){l(r)&&(r=se[r]),i(r)?r.call(e,t,n):f(r)&&i(r.attach)&&r.attach.call(e,t,n)}),Ot(T),e},blur:function(){Kt();var t=this,n=t._mask,e=t._tags,r=n.input;return x(e,function(t){return t[2].blur()}),r.blur(),t},detach:function(){var t=this,n=t._mask,e=t.mask,u=t.self,a=t.state,o=n.input,c=G(u);return t._active=!1,t._tags=new ve(t),t["_"+En]=null,c&&(Ut(fn,c,ce),Ut(cn,c,le)),Ut(Vt,o,Un),Ut(Yt,o,Gn),Ut(Zt,o,Xn),Ut(Zt,u,Qn),Ut(tn,o,Yn),Ut(nn,o,Wn),Ut(en,u,Zn),Ut(rn,o,ne),Ut(un,o,re),Ut(an,e,ae),Ut(on,o,ue),Ut(ln,e,ae),r(a.with)&&b(a.with,function(n,e){l(n)&&(n=se[n]),f(n)&&i(n.detach)&&n.detach.call(t,u,a)}),u[An]=null,it(u,"hidden"),at(u,a.n+"__self"),xt(e,u),ot(e),t._mask={of:u},t.mask=null,t},focus:function(t){var n=this;if(!n._active)return n;var e=n._mask.input;return Hn(e),qt(e,t),n},reset:function(t,n){var e=this;return e._active?(e[En]="",e[En]=e["_"+En],t?e.focus(n):e):e}}),C(ve,{name:{value:In+"Tags"}},1),ve._=R(ve,{at:function(t){return A(_(t),this[Cn])},count:function(){return this[Cn].size},delete:function(t,n){void 0===n&&(n=1);var e=this,r=e.of,i=e.values;if(!r._active)return!1;var u,a,o=r.min,f=r.self,l=r.state,s=l.join,v=l.n,d=[];if((u=e.count())<=o)return n&&Zn.call(f),n&&r.fire("min.tags",[u,o]),!1;if(!c(t))return x(i,function(t,n){return e.let(n,0)}),n&&r.fire("let.tags",[[]]).fire("change",[null]),0===e.count();if(!(a=A(t=_(t),i)))return Zn.call(f),n&&r.fire("not.tag",[t]),!1;var p=a[2],m=W("."+v+"__x",p);return Ut(Vt,p,Fn),Ut(Xt,p,$n),Ut(Yt,p,Jn),Ut(Zt,p,Vn),Ut(nn,p,Pn),Ut(rn,p,te),Ut(un,p,ee),Ut(an,p,oe),Ut(an,m,fe),Ut(on,p,ie),Ut(ln,p,oe),Ut(ln,m,fe),ot(m),ot(p),a=E(t,i),x(i,function(t,n){return d.push(h(n))}),St(f,d=d.join(s)),n&&r.fire("let.tag",[t]).fire("change",[""!==d?d:null]),a},get:function(t){var n=this.values,e=A(_(t),n);return e?F(e[2]):-1},has:function(t){return T(_(t),this[Cn])},let:function(t,n){return void 0===n&&(n=1),this.delete(t,n)},set:function(t,n,e){var u,f,s;void 0===e&&(e=1);var v=this,d=v.of,p=v.values;if(!d._active)return!1;var m,g,y,b,k,w,S=d._fix,j=d._mask,A=d.max,T=d.self,E=d.state,C=j.text,R=E.join,O=E.n,M=E.pattern,L=[];if((m=v.count())>=A)return e&&Zn.call(T),e&&d.fire("max.tags",[m,A]),!1;c(n)?(o(w=n)&&0!=w%1||a(n)||l(n))&&(n=[n,{active:!0,mark:!1}]):n=[t,{active:!0,mark:!1}],n[1].active=null==(u=n[1].active)||u,n[1].mark=null!=(f=n[1].mark)&&f;var q,K,I=n[1],z=I.mark,H=I.value;if(null===t||""===(H=h(H||t).trim())||l(M)&&!Gt(M).test(H))return Zn.call(T),e&&d.fire("not.tag",[t]),!1;i(M)&&(r(g=M.call(d,H))?(t=H=g[1]&&null!=(q=g[1][En])?q:g[0],n=g):l(g)&&(t=H=g,n[0]=g));return v.has(t=_(t))?(Zn.call(T),e&&d.fire("has.tag",[t]),!1):(y=n[2]||gt("data",{aria:{pressed:!!z&&Tn,selected:Tn},class:O+"__tag",contenteditable:Tn,inputmode:"none",role:"option",spellcheck:bn,tabindex:-1,title:null!=(s=X(n[1],"title"))&&s,value:H,virtualkeyboardpolicy:"manual"}),S&&(ut(y,_n),ut(y,jn)),b=n[2]?W("."+O+"__v",n[2]):gt("span",h(n[0]),{class:O+"__v",role:"none"}),O+="__x",k=n[2]?W("."+O,n[2]):gt("span",{aria:{hidden:Tn},class:O,tabindex:-1}),bt(b),bt(k),ct(k,"controls",U(bt(y))),n[2]||(Jt(Vt,y,Fn),Jt(Xt,y,$n),Jt(Yt,y,Jn),Jt(Zt,y,Vn),Jt(nn,y,Pn),Jt(rn,y,te),Jt(un,y,ee),Jt(an,y,oe),Jt(an,k,fe),Jt(on,y,ie),Jt(ln,y,oe),Jt(ln,k,fe)),vt(y,b),vt(y,k),K=y,C.before(K),N(y,d),n[2]=y,e&&d.fire("is.tag",[t]),D(t,n,p),x(p,function(t,n){return L.push(h(n))}),St(T,L=L.join(R)),e&&d.fire("set.tag",[t]).fire("change",[""!==L?L:null]),!0)}}),S(ve)[Symbol.iterator]=function(){return this[Cn][Symbol.iterator]()},se.Tags=ve,se});