/*!
 *
 * The MIT License (MIT)
 *
 * Copyright © 2025 Taufik Nurrohman <https://github.com/taufik-nurrohman>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the “Software”), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED “AS IS”, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */
!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(t="undefined"!=typeof globalThis?globalThis:t||self).TagPicker=n()}(this,(function(){"use strict";function t(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=Array(n);e<n;e++)r[e]=t[e];return r}function n(n,e,r){if(e&&!Array.isArray(e)&&"number"==typeof e.length){var i=e.length;return t(e,void 0!==r&&r<i?r:i)}return n(e,r)}function e(n,e){return function(t){if(Array.isArray(t))return t}(n)||function(t,n){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var r,i,u,a,o=[],f=!0,c=!1;try{if(u=(e=e.call(t)).next,0===n){if(Object(e)!==e)return;f=!1}else for(;!(f=(r=u.call(e)).done)&&(o.push(r.value),o.length!==n);f=!0);}catch(t){c=!0,i=t}finally{try{if(!f&&null!=e.return&&(a=e.return(),Object(a)!==a))return}finally{if(c)throw i}}return o}}(n,e)||function(n,e){if(n){if("string"==typeof n)return t(n,e);var r={}.toString.call(n).slice(8,-1);return"Object"===r&&n.constructor&&(r=n.constructor.name),"Map"===r||"Set"===r?Array.from(n):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?t(n,e):void 0}}(n,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var r=function(t){return Array.isArray(t)},i=function(t){return"function"==typeof t},u=function(t,n,e){return!(!t||"object"!=typeof t)&&(e?c(n)&&c(t.constructor)&&n===t.constructor:c(n)&&t instanceof n)},a=function(t){return o(t)&&0==t%1},o=function(t){return"number"==typeof t&&!Number.isNaN(t)},f=function(t,n){return void 0===n&&(n=!0),!(!t||"object"!=typeof t)&&(!n||u(t,Object,1))},c=function(t){return function(t){return void 0!==t}(t)&&!function(t){return null===t}(t)},s=function(t){return"string"==typeof t},l=function(t,n){return-1!==n.indexOf(t)},v=function(){for(var t=arguments.length,n=Array(t),e=0;e<t;e++)n[e]=arguments[e];for(var i=n.shift(),u=0,a=g(n);u<a;++u)for(var o in n[u])if(c(i[o]))if(r(i[o])&&r(n[u][o])){i[o]=[].concat(i[o]);for(var s=0,h=g(n[u][o]);s<h;++s)l(n[u][o][s],i[o])||i[o].push(n[u][o][s])}else f(i[o])&&f(n[u][o])?i[o]=v({},i[o],n[u][o]):i[o]=n[u][o];else i[o]=n[u][o];return i},h=function(t){if(r(t))return t.map((function(n){return h(t)}));if(f(t)){for(var n in t)t[n]=h(t[n]);return t}return!1===t?"false":null===t?"null":!0===t?"true":""+t},d=function(t){return t.replace(/[-_.](\w)/g,(function(t,n){return m(n)}))},p=function(t){return t.toLowerCase()},m=function(t){return t.toUpperCase()},g=function(t){return t.length},_=function(t){if(r(t))return t.map((function(t){return _(t)}));if(f(t)){for(var n in t)t[n]=_(t[n]);return t}return s(t)&&function(t){return/^[+-]?(?:\d*\.)?\d+$/.test(t+"")}(t)?"0"===t[0]&&-1===t.indexOf(".")?t:function(t,n){return void 0===n&&(n=10),n?parseInt(t,n):parseFloat(t)}(t):"false"!==t&&("null"===t?null:"true"===t||t)};var y=function(t,n){for(var e,r=0,i=g(t);r<i;++r)if(-1!==(e=n.call(t,t[r],r))){if(0===e)break}else t.splice(r,1);return t},b=function(t,r){for(var i=function(t){return t[Symbol.iterator]()}(t),u=i.next();!u.done;){var a=n(e,u.value,2),o=a[0],f=a[1];if(-1===(f=r.call(t,f,o)))S(o,t);else if(0===f)break;u=i.next()}return t},x=function(t,n){var e;for(var r in t)if(-1!==(e=n.call(t,t[r],r))){if(0===e)break}else delete t[r];return t},k=function(t){return t.prototype},w=function(t){return j(t,M)||null},j=function(t,n){return n.get(t)},A=function(t,n){return n.has(t)},S=function(t,n){return n.delete(t)},T=function(t,n,e){return e||(t=k(t)),x(n,(function(n,e){Object.defineProperty(t,e,n)})),t},E=function(t,n,e){return t=k(t),x(n,(function(n,e){t[e]=n})),t},C=function(t,n){return R(t,n,M)},R=function(t,n,e){return e.set(t,n)},N=function(t){return O(t).shift()},D=function(t){return O(t).pop()},O=function(t){var n=[];return b(t,(function(t){n.push(t)})),n},M=new WeakMap;var L=document,q=window,K=function(t,n,e){return void 0===e&&(e=!0),I(t,"aria-"+n,e)},I=function(t,n,e){if(void 0===e&&(e=!0),!Z(t,n))return null;var r=t.getAttribute(n);return e?_(r):r},z=function(t,n){return t["first"+(n?"":"Element")+"Child"]||null},H=function(t,n,e){var r,i=(r=t.childNodes,Array.from(r));return o(n)?i[n]||null:i},B=function(t,n){return(n||L).querySelector(t)},P=function(t,n){if(!t||!U(t))return-1;for(var e=0;t=J(t,n);)++e;return e},W=function(t,n){return void 0===n&&(n="e:"),tt(t)?I(t,"id"):(c(wt[n])||(wt[n]=0),n+(e=Date.now()+(wt[n]+=1),r=16,o(e)?e.toString(r):""+e));var e,r},F=function(t,n){return t["next"+(n?"":"Element")+"Sibling"]||null},U=function(t,n){return n?t.closest(n)||null:t.parentNode||null},$=function(t){var n="form";return nt(t,n)&&n===function(t){return p(t&&t.nodeName||"")||null}(t[n])?t[n]:U(t,n)},J=function(t,n){return t["previous"+(n?"":"Element")+"Sibling"]||null},G=function(t){return I(t,"role")},Q=function(t,n){return nt(t,n)&&t[n]||null},V=function(t,n){void 0===n&&(n=!0);var e="textContent";if(!nt(t,e))return!1;var r=t[e];return""!==(r=n?r.trim():r)?r:null},X=function(t){return t&&t.nodeType||null},Y=function(t,n){var e=(t.value||"").replace(/\r?\n|\r/g,"\n");return""!==(e=n?_(e):e)?e:null},Z=function(t,n){return t.hasAttribute(n)},tt=function(t){return Z(t,"id")},nt=function(t,n){return n in t},et=function(t,n){return rt(t,"aria-"+n)},rt=function(t,n){return t.removeAttribute(n),t},it=function(t,n){return t.classList.remove(n),t},ut=function(t){var n=U(t);return t.remove(),n},at=function(t,n){return t.style[d(n)]=null,t},ot=function(t,n,e){return ft(t,"aria-"+n,!0===e?"true":e)},ft=function(t,n,e){return!0===e&&(e=n),t.setAttribute(n,h(e)),t},ct=function(t,n){return x(n,(function(n,e){return"aria"===e&&f(n)?(function(t,n){x(n,(function(n,e){n||""===n||0===n?ot(t,e,n):et(t,e)}))}(t,n),1):"class"===e?(vt(t,n),1):"data"===e&&f(n)?(ht(t,n),1):"style"===e&&f(n)?(xt(t,n),1):void(n||""===n||0===n?ft(t,e,n):rt(t,e))})),t},st=function(t,n){return t.append(n),n},lt=function(t,n){return t.classList.add(n),t},vt=function(t,n){return r(n)?(y(n,(function(n){return lt(t,n)})),t):f(n)?(x(n,(function(n,e){return n?lt(t,e):it(t,e)})),t):(t.className=n,t)},ht=function(t,n){return x(n,(function(n,e){n||""===n||0===n?dt(t,e,n):function(t,n){rt(t,"data-"+n)}(t,e)})),t},dt=function(t,n,e){return(r(e)||f(e))&&(e=JSON.stringify(e)),ft(t,"data-"+n,!0===e?"true":e)},pt=function(t,n,e,i){return t=s(t)?L.createElement(t,s(i)?{is:i}:i):t,r(n)&&g(n)?(!function(t){var n="innerHTML";nt(t,n)&&(t[n]="")}(t),y(n,(function(t){return st(s(t)?mt(t):t)}))):f(n)&&(e=n,n=!1),s(n)&&gt(t,n),f(e)?(ct(t,e),t):t},mt=function(t){return s(t)&&(t=L.createTextNode(t)),t},gt=function(t,n,e){if(void 0===e&&(e=!0),null===n)return t;var r="innerHTML";return nt(t,r)&&(t[r]=e?n.trim():n),t},_t=function(t,n,e){return void 0===e&&(e="e:"),ft(t,"id",c(n)?n:W(t,e))},yt=function(t,n){return t.after(n),n},bt=function(t,n,e){return o(e)&&(e+="px"),t.style[d(n)]=h(e),t},xt=function(t,n){return x(n,(function(n,e){n||""===n||0===n?bt(t,e,n):at(t,e)})),t},kt=function(t,n){return null===n?rt(t,"value"):(t.value=h(n),t)},wt={},jt=Date.now,At=new WeakMap,St=new WeakMap,Tt=function(){return L.getSelection()},Et=function(){return L.createRange()},Ct=function(t,n){return(n||Tt()).rangeCount>0},Rt=function(t,n){return(n=n||Tt()).empty(),n},Nt=function(t,n,e){var r=0,i=Et();i.setStart(t,0),i.collapse(!0);for(var u,a,o,f=[t];!u&&(o=f.pop());)if(3===X(o)){var c=r+g(o);!a&&n[0]>=r&&n[0]<=c&&(i.setStart(o,n[0]-r),a=!0),a&&n[1]>=r&&n[1]<=c&&(u=!0,i.setEnd(o,n[1]-r)),r=c}else y(H(o,null),(function(t){return f.push(t)}));return Lt(t,i,Rt(0,e))},Dt=function(t,n){var e,r,i,u,a=null!=(e=j(t,At))?e:[],o=null!=(r=j(t,St))?r:g(a)-1,f=null!=(i=function(t,n){void 0===n&&(n=!0);var e="innerHTML";if(!nt(t,e))return!1;var r=t[e];return""!==(r=n?r.trim():r)?r:null}(t))?i:"";return u=Ct(t,n)?function(t){var n=Tt().getRangeAt(0),e=n.cloneRange();e.selectNodeContents(t),e.setEnd(n.startContainer,n.startOffset);var r=g(e+"");return[r,r+g(n+"")]}(t):[],a[o]&&f===a[o][0]&&u[0]===a[o][1][0]&&u[1]===a[o][1][1]||(o<g(a)-1&&a.splice(o+1),a.push([f,u,jt()]),R(t,a,At),R(t,++o,St)),t},Ot=function(t,n,e){e=e||Tt(),Rt(0,e);var r=Et();r.selectNodeContents(t),e=Lt(t,r,e),1===n?e.collapseToEnd():-1===n&&e.collapseToStart()},Mt=function(t,n){return(n=n||Tt()).rangeCount&&n.removeRange(n.getRangeAt(0)),n},Lt=function(t,n,e){return e=e||Tt(),r(n)?Nt(t,n,e):(e.addRange(n),e)};var qt=q.clearTimeout,Kt=q.setTimeout,It=function(t,n){var e,r=a(n)&&n>=0;return[function(){var i=this,u=Array.from(arguments);r||(n=u.shift()),e=Kt((function(){return t.apply(i,u)}),n)},function(){e&&qt(e)}]};var zt,Ht,Bt,Pt=function(t,n,e){n.removeEventListener(t,e)},Wt=function(t){return t&&t.preventDefault()},Ft=function(t,n,e,r){void 0===r&&(r=!1),n.addEventListener(t,e,r)},Ut=function(t,n){return function(t){return u(t,RegExp)}(t)?t:RegExp(t,c(n)?n:"g")},$t="down",Jt="blur",Gt="copy",Qt="cut",Vt="focus",Xt="input",Yt="before"+Xt,Zt="invalid",tn="key"+$t,nn="keyup",en="mouse"+$t,rn="paste",un="reset",an="submit",on="touchstart",fn="Arrow",cn=fn+"Left",sn=fn+"Right",ln="Home",vn="Backspace",hn="Enter",dn="Tab",pn="contenteditable",mn="disabled",gn="false",_n=Zt,yn="pressed",bn="readonly",xn="required",kn="tabindex",wn="tabIndex",jn="true",An="value",Sn=An+"s",Tn="visibility",En=n(e,It((function(t){et(t.mask,_n)})),2),Cn=En[0],Rn=En[1],Nn=function(t){var n=t.mask,e=t.state.time.error;a(e)&&e>0&&ot(n,_n,!0)},Dn=n(e,It((function(t){Dt(t)}),1),1)[0],On=n(e,It((function(t){var n=t._mask.input;Mn(t,V(n,0))})),1)[0],Mn=function(t,n){var e=t._mask.hint;n?bt(e,Tn,"hidden"):at(e,Tn)},Ln="TagPicker";function qn(t,n){var e=u(n,Map)?n:new Map;r(n)?y(n,(function(t){var n,i,u;r(t)?(t[0]=null!=(n=t[0])?n:"",t[1]=null!=(i=t[1])?i:{},R(_(null!=(u=t[1][An])?u:t[0]),t,e)):R(_(t),[t,{}],e)})):f(n,0)&&x(n,(function(t,i){var u,a,o;r(t)?(n[i][0]=null!=(u=t[0])?u:"",n[i][1]=null!=(a=t[1])?a:{},R(_(null!=(o=t[1][An])?o:i),t,e)):R(_(i),[t,{}],e)}));var i=t._tags,a=[];return i.let(null,0),b(e,(function(t,n){var e,u;r(t)&&t[1]&&a.push(null!=(u=t[1][An])?u:n);i.set(_(r(t)&&t[1]&&null!=(e=t[1][An])?e:n),t,0)})),a}function Kn(t){return t.focus(),t}function In(t,n){return Y(t,n)}function zn(t){Wt(t)}function Hn(t){var n=this,e=t.data,r=t.inputType,i=w(n),u=i._active,a=i._fix;if(!u||a)return Wt(t);var o,f,c,v,h=i._tags,d=i.state.escape;f=s(e)&&1===g(e)?e:0,hn===f&&(l("\n",d)||l(13,d))||dn===f&&(l("\t",d)||l(9,d))||0!==f&&l(f,d)?(o=!0,R(_(v=V(n)),v,h),Kn(i).text=""):"deleteContentBackward"!==r||V(n,0)||(c=D(h))&&(o=!0,S(In(c[2]),h)),o&&Wt(t)}function Bn(){var t=w(this)._tags;zt||Ht||b(t,(function(t){return et(t[2],yn)}))}function Pn(){var t=w(this),n=t.mask,e=t.state.time.error;Cn(a(e)&&e>0?e:0,t),Ft(en,n,re),Ft(on,n,re)}function Wn(t){Wt(t);var n=this,e=w(n),r=e._tags,i=e.state.join,u=[];ot(n,yn,!0),b(r,(function(t){K(t[2],yn)&&u.push(In(t[2]))})),t.clipboardData.setData("text/plain",u.join(i)),Qt!==t.type&&g(u)<2&&et(n,yn)}function Fn(t){Wt(t);var n=w(this),e=n._tags;Wn.call(this,t),b(e,(function(t){K(t[2],yn)&&S(In(t[2]),e)})),Kn(n.fire("change",[n[An]]))}function Un(){var t=this;Dt(t),On(1,w(t)),Dn(t)}function $n(){Kn(w(this))}function Jn(){Ot(this)}function Gn(){var t=this,n=w(t),e=n.mask,r=n.state.pattern,i=V(t);i&&s(r)&&!Ut(r).test(i)&&(Rn(),Nn(n)),Ot(t),Pt(en,e,re),Pt(on,e,re)}function Qn(t){var n=this,e=w(n),r=e._active,i=e._fix;if(!r||i)return Wt(t);var u=e.state.pattern,a=t.inputType,o=V(n,0);"deleteContent"!==a.slice(0,13)||o?"insertText"===a&&(Mn(e,1),Dn(n)):(Mn(e,0),Dn(n)),s(u)&&!Ut(u).test(o)?(Rn(),Nn(e)):Cn(0,e)}function Vn(t){t&&Wt(t);Pn.call(this),Nn(w(this))}function Xn(t){var n=Bt=this,e=t.key,r=zt=t.ctrlKey,i=Ht=t.shiftKey,u=w(n),a=u._active,o=u._fix;if(!a||o)return Wt(t);var f,c,s,l,v,h=u._mask,d=u._tags,p=h.text;i?(f=!0,ot(n,yn,!0),cn===e?(v=J(n))&&(K(v,yn)?et(n,yn):ot(v,yn,!0),Kn(v)):sn===e?(l=F(n))&&l!==p&&(K(l,yn)?et(n,yn):ot(l,yn,!0),Kn(l)):dn===e&&Mt()):r?"a"===e?(f=!0,b(d,(function(t){return ot(t[2],yn,!0),Kn(t[2]),Ot(t[2])}))):cn===e?(f=!0,(v=J(n))&&Kn(v)):sn===e?(f=!0,(l=F(n))&&l!==p&&Kn(l)):ln===e?(f=!0,(c=N(d))&&Kn(c[2])):"End"===e?(f=!0,(s=D(d))&&Kn(s[2])):hn===e||" "===e?(f=!0,K(n,yn)?et(n,yn):ot(n,yn,!0)):ot(n,yn,!0):cn===e?(f=!0,(v=J(n))&&Kn(v)):sn===e?(f=!0,Kn((l=F(n))&&l!==p?l:u)):ln===e?(f=!0,(c=N(d))&&Kn(c[2])):"End"===e?(f=!0,(s=D(d))&&Kn(s[2])):vn===e?(f=!0,v=J(n),S(In(n),d),b(d,(function(t){K(t[2],yn)&&(v=J(t[2]),S(In(t[2]),d))})),Kn(v||u),u.fire("change",[u[An]])):"Delete"===e?(f=!0,l=F(n),S(In(n),d),b(d,(function(t){K(t[2],yn)&&(l=F(t[2]),S(In(t[2]),d))})),Kn(l&&l!==p?l:u),u.fire("change",[u[An]])):hn===e||" "===e?(f=!0,K(n,yn)?et(n,yn):ot(n,yn,!0)):"Escape"===e||dn===e?(f=!0,Mt(),Kn(u)):1===g(e)&&(b(d,(function(t){K(t[2],yn)&&S(In(t[2]),d)})),Mt(),Kn(u).fire("change",[u[An]])),f&&Wt(t)}function Yn(t){var n=this,e=t.key,r=t.keyCode,u=zt=t.ctrlKey,a=Ht=t.shiftKey,o=w(n),f=o._active,c=o._fix;if(f&&!c){var s,v,h,d,m=o._tags,y=o.self,x=o.state.escape;if(hn===e&&(l("\n",x)||l(13,x))||dn===e&&(l("\t",x)||l(9,x))||l(e,x)||l(r,x))return R(_(d=V(n)),d,m),Kn(o).text="",Wt(t);On(1,o);var k,A,T,E,C,O,M,L,q,K=""===function(t,n,e){if(e=e||Tt(),!Ct(t,e))return null;var r=e.getRangeAt(0).cloneRange();return r.collapse(!0),r.setStart(t,0),(r+"").slice(-1)}(n),I=!V(n,0);a?cn===e?(K||I)&&(s=!0,Mt(),(A=D(m))&&Kn(A[2])&&ot(A[2],yn,!0)):hn===e?s=!0:dn===e&&Mt():u?"a"===p(e)&&I&&m.count()?(s=!0,b(m,(function(t){return ot(t[2],yn,!0),Kn(t[2]),Ot(t[2])}))):cn===e?(s=!0,(A=D(m))&&Kn(A[2])):ln===e?(s=!0,(k=N(m))&&Kn(k[2])):hn===e?s=!0:a||"z"!==p(e)?(a&&"z"===p(e)||"y"===p(e))&&(s=!0,function(t,n){var e,r,i,u=null!=(e=j(t,At))?e:[],a=null!=(r=j(t,St))?r:g(u)-1;(i=u[a+1])?(a++,R(t,a,St),gt(t,i[0]),Nt(t,i[1],n)):Nt(t,u[a][1],n)}(n)):(s=!0,L=null!=(C=j(T=n,At))?C:[],q=null!=(O=j(T,St))?O:g(L)-1,(M=L[q-1])?(q--,R(T,q,St),gt(T,M[0]),Nt(T,M[1],E)):Nt(T,L[q][1],E)):ln===e?(s=!0,(k=N(m))&&Kn(k[2])):hn===e?(s=!0,(v=$(y))&&i(v.requestSubmit)&&((h=B("button:not([type]),button[type=submit],input[type=image],input[type=submit]",v))?v.requestSubmit(h):v.requestSubmit())):dn===e?Mt():(K||I)&&(cn===e?(s=!0,Mt(),(A=D(m))&&Kn(A[2])):vn===e&&I&&(s=!0,(A=D(m))&&S(In(A[2]),m))),s&&Wt(t)}}function Zn(t){Bt=0;var n=t.key,e=w(this)._tags,r=0;b(e,(function(t){K(t[2],yn)&&++r})),zt=t.ctrlKey,Ht=t.shiftKey,r<2&&!zt&&!Ht&&hn!==n&&" "!==n&&et(this,yn)}function te(t){zt=t.ctrlKey,Ht=t.shiftKey}function ne(t){Wt(t);var n=w(this),e=n._tags,r=n.state.join;y(t.clipboardData.getData("text/plain").split(r),(function(t){A(t=_(t.trim()),e)||R(t,t,e)})),b(e,(function(t){return et(t[2],yn)})),Kn(n.fire("change",[n[An]]))}function ee(t){Wt(t);var n,e=this,i=w(e),u=i._tags,a=i.self,o=i.state.join;Dt(e),On(1,i),function(t,n,e,i){var u,a,o,f,c,l;if(i=i||Tt(),!Ct(t,i))return!1;if((a=i.getRangeAt(0)).deleteContents(),o=L.createDocumentFragment(),s(n))for(u=pt("div"),gt(u,n);f=z(u,1);)l=st(o,f);else r(n)?y(n,(function(t){return l=st(o,t)})):l=st(o,n);c=z(o,1),a.insertNode(o),l&&((a=a.cloneRange()).setStartAfter(l),a.setStartBefore(c),a.collapse(),Lt(t,a,Mt(t,i)))}(e,n=t.clipboardData.getData("text/plain")),Dn(e),n!==V(e)||(y((V(e)+"").split(o),(function(t){A(t=_(t.trim()),u)?(Vn.call(a),i.fire("has.tag",[_(t)])):R(t,t,u)})),b(u,(function(t){return et(t[2],yn)})),i.fire("change",[i[An]]).text="")}function re(t){Wt(t);var n=w(this),e=t.target;if(!e||"option"!==G(e)){for(;e&&this!==e;)if((e=U(e))&&"option"===G(e))return;Kn(n)}}function ie(t){Wt(t);var n=this,e=w(n)._tags;if(Kn(n),Ot(n),zt||b(e,(function(t){return et(t[2],yn)})),zt)ot(n,yn,!0);else if(Ht&&Bt){var r,i,u=P(n),a=P(Bt),o=Bt;if(ot(n,yn,!0),ot(Bt,yn,!0),u>a)for(;(r=F(o))&&n!==r;)ot(o=r,yn,!0);else if(u<a)for(;(i=J(o))&&n!==i;)ot(o=i,yn,!0)}}function ue(t){Wt(t);var n=U(this),e=w(n),r=e._active,i=e._fix;if(!r||i)return Kn(e);var u=e._tags;S(In(n),u),Kn(e)}function ae(){w(this).reset()}function oe(t){var n,e=w(this),r=e._tags,i=e.max,u=e.min,a=e.self,o=r.count();o>i?(n=!0,Kn(e.fire("max.tags",[o,i]))):o<u&&(n=!0,Kn(e.fire("min.tags",[o,u]))),n&&(Vn.call(a),Wt(t))}function fe(t,n){var e=this;if(!t)return e;if(!u(e,fe))return new fe(t,n);C(t,function(t,n){return(n=n||t).fire=function(t,n,e){var r=this,i=r.hooks;return c(i[t])?(y(i[t],(function(t){t.apply(e||r,n)})),r):r},n.off=function(t,n){var e=this,r=e.hooks;if(!c(t))return r={},e;if(c(r[t]))if(c(n)){var i=g(r[t]);if(0===i)delete r[t];else for(var u=0;u<i;++u)if(n===r[t][u]){r[t].splice(u,1);break}}else delete r[t];return e},n.on=function(t,n){var e=this.hooks;return c(e[t])||(e[t]=[]),c(n)&&e[t].push(n),this},t.hooks={},t}(e,fe._));var r=v({},fe.state,s(n)?{join:n}:n||{});return f(n)&&n.escape&&(r.escape=n.escape),e.attach(t,r)}function ce(t,n){var e=this;return u(e,ce)?(e.of=t,e[Sn]=new Map,n&&qn(t,n),e):new ce(t,n)}return fe.from=function(t,n){return new fe(t,n)},fe.of=w,fe.state={escape:[","],join:", ",max:1/0,min:0,n:"tag-picker",pattern:null,time:{error:1e3},with:[]},fe.version="4.2.7",T(fe,{name:{value:Ln}},1),T(fe,{active:{get:function(){return this._active},set:function(t){Mt();var n=this,e=n._mask,r=n._tags,i=n.mask,u=n.self,a=e.input,o=!!t;return u[mn]=!(n._active=o),o?(et(a,mn),et(i,mn),ft(a,pn,""),b(r,(function(t){ft(t[2],pn,""),ft(t[2],kn,-1)}))):(rt(a,pn),ot(a,mn,!0),ot(i,mn,!0),b(r,(function(t){rt(t[2],pn),rt(t[2],kn)}))),n}},fix:{get:function(){return this._fix},set:function(t){Mt();var n=this,e=n._mask,r=n._tags,i=n.mask,u=n.self,a=e.input,o=!!t;return u.readOnly=n._fix=o,o?(rt(a,pn),ot(a,bn,!0),ot(i,bn,!0),ft(a,kn,0),b(r,(function(t){rt(t[2],pn),rt(t[2],kn)}))):(et(a,bn),et(i,bn),rt(a,kn),ft(a,pn,""),b(r,(function(t){ft(t[2],pn,""),ft(t[2],kn,-1)}))),n}},max:{get:function(){var t=this.state.max;return 1/0===t||a(t)&&t>=0?t:1/0},set:function(t){return this.state.max=a(t)&&t>=0?t:1/0,this}},min:{get:function(){var t=this.state.min;return a(t)&&t>=0?t:0},set:function(t){return this.state.min=a(t)&&t>=0?t:0,this}},tags:{get:function(){return this._tags},set:function(t){Mt();var n=this,e=[];return qn(n,t),b(n._tags,(function(t){return e.push(In(t[2],1))})),n.fire("set.tags",[e])}},text:{get:function(){return V(this._mask.input)},set:function(t){var n,e=this,r=e._active,i=e._fix;return!r||i||(function(t,n,e){if(void 0===e&&(e=!0),null===n)return t;var r="textContent";nt(t,r)&&(t[r]=e?n.trim():n)}(e._mask.input,n=h(t)),Mn(e,n)),e}},value:{get:function(){var t=Y(this.self);return""!==t?t:null},set:function(t){var n=this;if(!n._active)return n;var e=n._tags,r=n.state.join;return n[An]&&y(n[An].split(r),(function(t){return S(t,e)})),t&&y(t.split(r),(function(t){return R(t,t,e)})),n.fire("change",[n[An]])}},vital:{get:function(){return this._vital},set:function(t){Mt();var n=this,e=n._mask,r=n.mask,i=n.min,u=n.self,a=e.input,o=!!t;return u[xn]=n._vital=o,o?(0===i&&(n.min=1),ot(a,xn,!0),ot(r,xn,!0)):(n.min=0,et(a,xn),et(r,xn)),n}}}),fe._=E(fe,{attach:function(t,n){var e=this;t=t||e.self,n&&s(n)&&(n={join:n}),n=v({},e.state,n||{}),e._tags=new ce(e),e.self=t,e.state=n;var u=n,o=u.max,l=u.min,h=u.n,d=t.disabled,p=function(t){return t.readOnly}(t),m=function(t){return t.required}(t),g=t.id,_=t.name,b=t.placeholder,x=Y(t);e._active=!d,e._fix=p,e._vital=m,m&&l<1&&(n.min=l=1);var k=$(t),w=pt("div",{aria:{disabled:!!d&&jn,multiselectable:jn,readonly:!!p&&jn,required:!!m&&jn},class:h,role:"listbox"});e.mask=w;var j=pt("span",{class:h+"__flex",role:"none"}),A=pt("span",{class:h+"__text",role:"none"}),S=pt("span",{aria:{disabled:!!d&&jn,multiline:gn,placeholder:b,readonly:!!p&&jn,required:!!m&&jn},autocapitalize:"off",contenteditable:!d&&!p&&"",role:"textbox",spellcheck:gn,tabindex:!!p&&0}),T=pt("span",b+"",{aria:{hidden:jn}});st(w,j),st(j,A),st(A,S),st(A,T),ot(t,"hidden",!0),lt(t,h+"__self"),C(S,e),yt(t,w),st(w,t),k&&(Ft(un,k,ae),Ft(an,k,oe),_t(k),C(k,e)),Ft(Jt,S,Pn),Ft(Qt,S,Un),Ft(Vt,t,$n),Ft(Vt,S,Gn),Ft(Xt,S,Qn),Ft(Yt,S,Hn),Ft(Zt,t,Vn),Ft(tn,S,Yn),Ft(nn,S,te),Ft(en,w,re),Ft(rn,S,ee),Ft(on,w,re),t[wn]=-1,C(w,e),e._mask={flex:j,hint:T,input:S,of:t,self:w,text:A},e.max=o=1/0===o||a(o)&&o>=0?o:1/0,e.min=l=a(l)&&l>=0?l:0;var E,R=e._active,N=n.join;return e._active=!0,E=qn(e,x?x.split(N):[]),e["_"+An]=E.join(N),e._active=R,ot(S,"controls",W(_t(j))),_t(w),_t(t),_t(S),_t(T),g&&dt(w,"id",g),_&&dt(w,"name",_),c(n)&&r(n.with)&&y(n.with,(function(r,u){s(r)&&(r=fe[r]),i(r)?r.call(e,t,n):f(r)&&i(r.attach)&&r.attach.call(e,t,n)})),Dt(S),e},blur:function(){Mt();var t=this,n=t._mask,e=t._tags,r=n.input;return b(e,(function(t){return t[2].blur()})),r.blur(),t},detach:function(){var t=this,n=t._mask,e=t.mask,u=t.self,a=t.state,o=n.input,c=$(u);return t._active=!1,t._tags=new ce(t),t["_"+An]=null,c&&(Pt(un,c,ae),Pt(an,c,oe)),Pt(Jt,o,Pn),Pt(Qt,o,Un),Pt(Vt,o,Gn),Pt(Vt,u,$n),Pt(Xt,o,Qn),Pt(Yt,o,Hn),Pt(Zt,u,Vn),Pt(tn,o,Yn),Pt(nn,o,te),Pt(en,e,re),Pt(rn,o,ee),Pt(on,e,re),r(a.with)&&y(a.with,(function(n,e){s(n)&&(n=fe[n]),f(n)&&i(n.detach)&&n.detach.call(t,u,a)})),u[wn]=null,et(u,"hidden"),it(u,a.n+"__self"),yt(e,u),ut(e),t._mask={of:u},t.mask=null,t},focus:function(t){var n=this;if(!n._active)return n;var e=n._mask.input;return Kn(e),Ot(e,t),n},reset:function(t,n){var e=this;return e._active?(e[An]=e["_"+An],t?e.focus(n):e):e}}),T(ce,{name:{value:Ln+"Tags"}},1),ce._=E(ce,{at:function(t){return j(_(t),this[Sn])},count:function(){return this[Sn].size},delete:function(t,n){void 0===n&&(n=1);var e=this,r=e.of,i=e.values;if(!r._active)return!1;var u,a,o=r.min,f=r.self,s=r.state,l=s.join,v=s.n,d=[];if((u=e.count())<=o)return n&&Vn.call(f),n&&r.fire("min.tags",[u,o]),!1;if(!c(t))return b(i,(function(t,n){return e.let(n,0)})),n&&r.fire("let.tags",[[]]).fire("change",[null]),0===e.count();if(!(a=j(t=_(t),i)))return Vn.call(f),n&&r.fire("not.tag",[t]),!1;var p=a[2],m=B("."+v+"__x",p);return Pt(Jt,p,Bn),Pt(Gt,p,Wn),Pt(Qt,p,Fn),Pt(Vt,p,Jn),Pt(Yt,p,zn),Pt(tn,p,Xn),Pt(nn,p,Zn),Pt(en,p,ie),Pt(en,m,ue),Pt(rn,p,ne),Pt(on,p,ie),Pt(on,m,ue),ut(m),ut(p),a=S(t,i),b(i,(function(t,n){return d.push(h(n))})),kt(f,d=d.join(l)),n&&r.fire("let.tag",[t]).fire("change",[""!==d?d:null]),a},get:function(t){var n=this.values,e=j(_(t),n);return e?P(e[2]):-1},has:function(t){return A(_(t),this[Sn])},let:function(t,n){return void 0===n&&(n=1),this.delete(t,n)},set:function(t,n,e){var u,f,l;void 0===e&&(e=1);var v=this,d=v.of,p=v.values;if(!d._active)return!1;var m,g,y,x,k,w,j=d._fix,A=d._mask,S=d.max,T=d.self,E=d.state,N=A.text,D=E.join,O=E.n,M=E.pattern,L=[];if((m=v.count())>=S)return e&&Vn.call(T),e&&d.fire("max.tags",[m,S]),!1;c(n)?(o(w=n)&&0!=w%1||a(n)||s(n))&&(n=[n,{active:!0,mark:!1}]):n=[t,{active:!0,mark:!1}],n[1].active=null==(u=n[1].active)||u,n[1].mark=null!=(f=n[1].mark)&&f;var q,K,I=n[1],z=I.mark,H=I.value;if(null===t||""===(H=h(H||t).trim())||s(M)&&!Ut(M).test(H))return Vn.call(T),e&&d.fire("not.tag",[t]),!1;i(M)&&(r(g=M.call(d,H))?(t=H=g[1]&&null!=(q=g[1][An])?q:g[0],n=g):s(g)&&(t=H=g,n[0]=g));return v.has(t=_(t))?(Vn.call(T),e&&d.fire("has.tag",[t]),!1):(y=n[2]||pt("data",{aria:{pressed:!!z&&jn,selected:jn},class:O+"__tag",contenteditable:jn,inputmode:"none",role:"option",spellcheck:gn,tabindex:-1,title:null!=(l=Q(n[1],"title"))&&l,value:H,virtualkeyboardpolicy:"manual"}),j&&(rt(y,pn),rt(y,kn)),x=n[2]?B("."+O+"__v",n[2]):pt("span",h(n[0]),{class:O+"__v",role:"none"}),O+="__x",k=n[2]?B("."+O,n[2]):pt("span",{aria:{hidden:jn},class:O,tabindex:-1}),_t(x),_t(k),ot(k,"controls",W(_t(y))),n[2]||(Ft(Jt,y,Bn),Ft(Gt,y,Wn),Ft(Qt,y,Fn),Ft(Vt,y,Jn),Ft(Yt,y,zn),Ft(tn,y,Xn),Ft(nn,y,Zn),Ft(en,y,ie),Ft(en,k,ue),Ft(rn,y,ne),Ft(on,y,ie),Ft(on,k,ue)),st(y,x),st(y,k),K=y,N.before(K),C(y,d),n[2]=y,e&&d.fire("is.tag",[t]),R(t,n,p),b(p,(function(t,n){return L.push(h(n))})),kt(T,L=L.join(D)),e&&d.fire("set.tag",[t]).fire("change",[""!==L?L:null]),!0)}}),k(ce)[Symbol.iterator]=function(){return this[Sn][Symbol.iterator]()},fe.Tags=ce,fe}));